{"ast":null,"code":"export default function ValueReader(acceptedTypes, isNullable, defaultValue) {\n  this.acceptedTypes = acceptedTypes;\n  this.isNullable = isNullable;\n  this.defaultValue = defaultValue;\n  this.hash = {};\n  /* collect valid enumeration values */\n\n  for (var index = 0; index < acceptedTypes.length; index += 1) {\n    var acceptedType = acceptedTypes[index];\n    this.hash[acceptedType] = true;\n  }\n}\n;\n\nValueReader.prototype.stringify = function (target) {\n  if (this.hash[\"object\"] == true) {\n    var processed = [];\n    var result = JSON.stringify(target, function (key, value) {\n      if (key[0] === '_') {\n        return null;\n      }\n\n      if (value !== null && typeof value == \"object\") {\n        if (processed.indexOf(value) == -1) {\n          processed.push(value);\n          return value;\n        }\n\n        return null;\n      }\n\n      return value;\n    });\n    return result;\n  }\n\n  return target;\n};\n\nValueReader.prototype.read = function (target, source, path, context) {\n  var result = null;\n\n  if (source === null || typeof source == \"undefined\" || !this.hash.hasOwnProperty(typeof source)) {\n    source = this.isNullable ? null : this.defaultValue;\n  }\n\n  result = source;\n\n  if (this.stringify(target) !== this.stringify(source)) {\n    context.isChanged = true;\n  }\n\n  return result;\n};","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/node_modules/basicprimitives/src/readers/ValueReader.js"],"names":["ValueReader","acceptedTypes","isNullable","defaultValue","hash","index","length","acceptedType","prototype","stringify","target","processed","result","JSON","key","value","indexOf","push","read","source","path","context","hasOwnProperty","isChanged"],"mappings":"AAAA,eAAe,SAASA,WAAT,CAAqBC,aAArB,EAAoCC,UAApC,EAAgDC,YAAhD,EAA8D;AAC3E,OAAKF,aAAL,GAAqBA,aAArB;AACA,OAAKC,UAAL,GAAkBA,UAAlB;AACA,OAAKC,YAAL,GAAoBA,YAApB;AAEA,OAAKC,IAAL,GAAY,EAAZ;AAEA;;AACA,OAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGJ,aAAa,CAACK,MAA1C,EAAkDD,KAAK,IAAI,CAA3D,EAA8D;AAC5D,QAAIE,YAAY,GAAGN,aAAa,CAACI,KAAD,CAAhC;AACA,SAAKD,IAAL,CAAUG,YAAV,IAA0B,IAA1B;AACD;AACF;AAAA;;AAEDP,WAAW,CAACQ,SAAZ,CAAsBC,SAAtB,GAAkC,UAAUC,MAAV,EAAkB;AAClD,MAAI,KAAKN,IAAL,CAAU,QAAV,KAAuB,IAA3B,EAAiC;AAC/B,QAAIO,SAAS,GAAG,EAAhB;AACA,QAAIC,MAAM,GAAGC,IAAI,CAACJ,SAAL,CAAeC,MAAf,EAAuB,UAAUI,GAAV,EAAeC,KAAf,EAAsB;AACxD,UAAID,GAAG,CAAC,CAAD,CAAH,KAAW,GAAf,EAAoB;AAClB,eAAO,IAAP;AACD;;AACD,UAAIC,KAAK,KAAK,IAAV,IAAkB,OAAOA,KAAP,IAAgB,QAAtC,EAAgD;AAC9C,YAAIJ,SAAS,CAACK,OAAV,CAAkBD,KAAlB,KAA4B,CAAC,CAAjC,EAAoC;AAClCJ,UAAAA,SAAS,CAACM,IAAV,CAAeF,KAAf;AACA,iBAAOA,KAAP;AACD;;AACD,eAAO,IAAP;AACD;;AACD,aAAOA,KAAP;AACD,KAZY,CAAb;AAaA,WAAOH,MAAP;AACD;;AACD,SAAOF,MAAP;AACD,CAnBD;;AAqBAV,WAAW,CAACQ,SAAZ,CAAsBU,IAAtB,GAA6B,UAAUR,MAAV,EAAkBS,MAAlB,EAA0BC,IAA1B,EAAgCC,OAAhC,EAAyC;AACpE,MAAIT,MAAM,GAAG,IAAb;;AAEA,MAAIO,MAAM,KAAK,IAAX,IAAmB,OAAOA,MAAP,IAAiB,WAApC,IAAmD,CAAC,KAAKf,IAAL,CAAUkB,cAAV,CAAyB,OAAOH,MAAhC,CAAxD,EAAiG;AAC/FA,IAAAA,MAAM,GAAG,KAAKjB,UAAL,GAAkB,IAAlB,GAAyB,KAAKC,YAAvC;AACD;;AAEDS,EAAAA,MAAM,GAAGO,MAAT;;AAEA,MAAI,KAAKV,SAAL,CAAeC,MAAf,MAA2B,KAAKD,SAAL,CAAeU,MAAf,CAA/B,EAAuD;AACrDE,IAAAA,OAAO,CAACE,SAAR,GAAoB,IAApB;AACD;;AAED,SAAOX,MAAP;AACD,CAdD","sourcesContent":["export default function ValueReader(acceptedTypes, isNullable, defaultValue) {\n  this.acceptedTypes = acceptedTypes;\n  this.isNullable = isNullable;\n  this.defaultValue = defaultValue;\n\n  this.hash = {};\n\n  /* collect valid enumeration values */\n  for (var index = 0; index < acceptedTypes.length; index += 1) {\n    var acceptedType = acceptedTypes[index];\n    this.hash[acceptedType] = true;\n  }\n};\n\nValueReader.prototype.stringify = function (target) {\n  if (this.hash[\"object\"] == true) {\n    var processed = [];\n    var result = JSON.stringify(target, function (key, value) {\n      if (key[0] === '_') {\n        return null;\n      }\n      if (value !== null && typeof value == \"object\") {\n        if (processed.indexOf(value) == -1) {\n          processed.push(value);\n          return value;\n        }\n        return null;\n      }\n      return value;\n    });\n    return result;\n  }\n  return target;\n}\n\nValueReader.prototype.read = function (target, source, path, context) {\n  var result = null;\n\n  if (source === null || typeof source == \"undefined\" || !this.hash.hasOwnProperty(typeof source)) {\n    source = this.isNullable ? null : this.defaultValue;\n  }\n\n  result = source;\n\n  if (this.stringify(target) !== this.stringify(source)) {\n    context.isChanged = true;\n  }\n\n  return result;\n};"]},"metadata":{},"sourceType":"module"}