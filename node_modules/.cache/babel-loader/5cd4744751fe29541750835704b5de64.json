{"ast":null,"code":"import _objectSpread from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _assertThisInitialized from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _slicedToArray from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{OrgDiagram}from'../Diagrams';import{LCA,Tree,Colors,PageFitMode,Enabled,OrientationType}from'basicprimitives';import{DndProvider,useDrag,useDrop}from'react-dnd';import{HTML5Backend}from'react-dnd-html5-backend';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=/*#__PURE__*/function(_Component){_inherits(Container,_Component);var _super=_createSuper(Container);function Container(){_classCallCheck(this,Container);return _super.apply(this,arguments);}_createClass(Container,[{key:\"render\",value:function render(){var ItemTypes={NODE:'node'};function NodeDragDropSource(_ref){var itemConfig=_ref.itemConfig,canDropItem=_ref.canDropItem,onDropItem=_ref.onDropItem,isDragging=_ref.isDragging;var _useDrag=useDrag({item:{type:ItemTypes.NODE,id:itemConfig.id},collect:function collect(monitor){return{opacity:monitor.isDragging()?0.5:1};}}),_useDrag2=_slicedToArray(_useDrag,2),opacity=_useDrag2[0].opacity,dragRef=_useDrag2[1];var _useDrop=useDrop({accept:ItemTypes.NODE,drop:function drop(item,monitor){var didDrop=monitor.didDrop();if(didDrop&&item.id===itemConfig.id){return;}onDropItem(itemConfig.id,item.id);},canDrop:function canDrop(item,monitor){return canDropItem(itemConfig.id,item.id);},collect:function collect(monitor){return{isOver:monitor.isOver({shallow:true}),canDrop:monitor.canDrop()};}}),_useDrop2=_slicedToArray(_useDrop,2),_useDrop2$=_useDrop2[0],isOver=_useDrop2$.isOver,canDrop=_useDrop2$.canDrop,drop=_useDrop2[1];var itemTitleColor=itemConfig.itemTitleColor!=null?itemConfig.itemTitleColor:Colors.RoyalBlue;if(isOver){if(canDrop){itemTitleColor=\"green\";}else{itemTitleColor=\"red\";}}return/*#__PURE__*/_jsx(\"div\",{ref:drop,style:{width:\"100%\",height:\"100%\"},children:/*#__PURE__*/_jsxs(\"div\",{ref:dragRef,className:\"ContactTemplate\",style:{opacity:opacity},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitleBackground\",style:{backgroundColor:itemTitleColor},children:/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitle\",children:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhotoFrame\",children:/*#__PURE__*/_jsx(\"img\",{className:\"ContactPhoto\",src:itemConfig.image,alt:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhone\",children:itemConfig.phone}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactEmail\",children:itemConfig.email}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactDescription\",children:itemConfig.description})]})});}var Sample=/*#__PURE__*/function(_Component2){_inherits(Sample,_Component2);var _super2=_createSuper(Sample);function Sample(){var _this;_classCallCheck(this,Sample);_this=_super2.call(this);_this.onRemoveItem=_this.onRemoveItem.bind(_assertThisInitialized(_this));_this.canDropItem=_this.canDropItem.bind(_assertThisInitialized(_this));_this.onMoveItem=_this.onMoveItem.bind(_assertThisInitialized(_this));_this.state={cursorItem:0,highlightItem:0,items:[{id:0,parent:null,description:\"Chief Executive Officer (CEO)\",email:\"davidalt@name.com\",image:\"/react/photos/q.png\",itemTitleColor:\"#4169e1\",phone:\"352-206-7599\",title:\"David Dalton\",label:\"David Dalton\"},{id:1,parent:0,description:\"Co-Presidents, Platform Products & Services Division\",email:\"jeanwhit@name.com\",image:\"/react/photos/w.png\",phone:\"505-791-1689\",title:\"Jeanna White\",label:\"Jeanna White\"},{id:2,parent:0,description:\"Sr. VP, Server & Tools Division\",email:\"jameholt@name.com\",image:\"/react/photos/e.png\",phone:\"262-215-7998\",title:\"James Holt\",label:\"James Holt\"},{id:3,parent:null,description:\"VP, Server & Tools Marketing and Solutions\",email:\"thomwill@name.com\",image:\"/react/photos/r.png\",phone:\"904-547-5342\",title:\"Thomas Williams\",label:\"Thomas Williams\"},{id:4,parent:3,description:\"VP, Software & Enterprise Management Division\",email:\"sarakemp@name.com\",image:\"/react/photos/g.png\",phone:\"918-257-4218\",title:\"Sara Kemp\",label:\"Sara Kemp\"},{id:5,parent:3,description:\"Sr. VP, Software Server System\",email:\"georduon@name.com\",image:\"/react/photos/x.png\",phone:\"434-406-2189\",title:\"George Duong\",label:\"George Duong\"}]};return _this;}_createClass(Sample,[{key:\"onMoveItem\",value:function onMoveItem(parentid,itemid){var items=this.state.items;this.setState({cursorItem:itemid,items:items.map(function(item){if(item.id===itemid){return _objectSpread(_objectSpread({},item),{},{parent:parentid});}return item;})});}},{key:\"canDropItem\",value:function canDropItem(parentid,itemid){var items=this.state.items;var tree=this.getTree(items);var result=parentid!==itemid;tree.loopParents(this,parentid,function(id,node){if(id===itemid){result=false;return true;}});return result;}},{key:\"onRemoveItem\",value:function onRemoveItem(id){var items=this.state.items;this.setState(this.getDeletedItems(items,[id]));}},{key:\"getDeletedItems\",value:function getDeletedItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var deletedItems=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var tree=this.getTree(items);var hash=deletedItems.reduce(function(agg,itemid){agg.add(itemid.toString());return agg;},new Set());var cursorParent=this.getDeletedItemsParent(tree,deletedItems,hash);var result=[];tree.loopLevels(this,function(nodeid,node){if(hash.has(nodeid.toString())){return tree.SKIP;}result.push(node);});return{items:result,cursorItem:cursorParent};}},{key:\"getDeletedItemsParent\",value:function getDeletedItemsParent(tree,deletedItems,deletedHash){var result=null;var lca=LCA(tree);result=deletedItems.reduce(function(agg,itemid){if(agg==null){agg=itemid;}else{agg=lca.getLowestCommonAncestor(agg,itemid);}return agg;},null);if(deletedHash.has(result.toString())){result=tree.parentid(result);}return result;}},{key:\"getTree\",value:function getTree(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var tree=Tree();for(var index=0;index<items.length;index+=1){var item=items[index];tree.add(item.parent,item.id,item);}return tree;}},{key:\"render\",value:function render(){var _this2=this;var config=_objectSpread(_objectSpread({},this.state),{},{pageFitMode:PageFitMode.None,hasSelectorCheckbox:Enabled.True,orientationType:OrientationType.Top,defaultTemplateName:\"contactTemplate\",templates:[{name:\"contactTemplate\",itemSize:{width:220,height:120},minimizedItemSize:{width:3,height:3},highlightPadding:{left:2,top:2,right:2,bottom:2},onItemRender:function onItemRender(_ref2){var itemConfig=_ref2.context;return/*#__PURE__*/_jsx(NodeDragDropSource,{itemConfig:itemConfig,onRemoveItem:_this2.onRemoveItem,canDropItem:_this2.canDropItem,onDropItem:_this2.onMoveItem});}}]});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"placeholder\",style:{clear:'both'},children:/*#__PURE__*/_jsx(OrgDiagram,{centerOnCursor:true,config:config})})});}}]);return Sample;}(Component);return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsx(Sample,{})});}}]);return Container;}(Component);export default Container;","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/src/Samples/DragNDropHooks.js"],"names":["React","Component","OrgDiagram","LCA","Tree","Colors","PageFitMode","Enabled","OrientationType","DndProvider","useDrag","useDrop","HTML5Backend","Container","ItemTypes","NODE","NodeDragDropSource","itemConfig","canDropItem","onDropItem","isDragging","item","type","id","collect","monitor","opacity","dragRef","accept","drop","didDrop","canDrop","isOver","shallow","itemTitleColor","RoyalBlue","width","height","backgroundColor","title","image","phone","email","description","Sample","onRemoveItem","bind","onMoveItem","state","cursorItem","highlightItem","items","parent","label","parentid","itemid","setState","map","tree","getTree","result","loopParents","node","getDeletedItems","deletedItems","hash","reduce","agg","add","toString","Set","cursorParent","getDeletedItemsParent","loopLevels","nodeid","has","SKIP","push","deletedHash","lca","getLowestCommonAncestor","index","length","config","pageFitMode","None","hasSelectorCheckbox","True","orientationType","Top","defaultTemplateName","templates","name","itemSize","minimizedItemSize","highlightPadding","left","top","right","bottom","onItemRender","context","clear"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { OrgDiagram } from '../Diagrams';\nimport { LCA, Tree, Colors, PageFitMode, Enabled, OrientationType } from 'basicprimitives';\nimport { DndProvider, useDrag, useDrop } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nclass Container extends Component {\n  render() {\n    const ItemTypes = {\n      NODE: 'node'\n    }\n\n    function NodeDragDropSource({ itemConfig, canDropItem, onDropItem, isDragging }) {\n      const [{ opacity }, dragRef] = useDrag({\n        item: { type: ItemTypes.NODE, id: itemConfig.id },\n        collect: (monitor) => ({\n          opacity: monitor.isDragging() ? 0.5 : 1\n        })\n      })\n      const [{ isOver, canDrop }, drop] = useDrop({ \n            accept: ItemTypes.NODE,\n            drop(item, monitor) {\n                const didDrop = monitor.didDrop();\n                if (didDrop && item.id === itemConfig.id) {\n                    return;\n                }\n                onDropItem(itemConfig.id, item.id);\n            },\n            canDrop(item, monitor) {\n                return canDropItem(itemConfig.id, item.id);\n            },\n            collect: (monitor) => ({\n                isOver: monitor.isOver({ shallow: true }),\n                canDrop: monitor.canDrop()\n            }),      \n        })\n      \n      let itemTitleColor = itemConfig.itemTitleColor != null ? itemConfig.itemTitleColor : Colors.RoyalBlue;\n      if (isOver) {\n        if (canDrop) {\n          itemTitleColor = \"green\";\n        } else {\n          itemTitleColor = \"red\";\n        }\n      }\n\n      return (\n        <div ref={drop} style = {{width: \"100%\", height: \"100%\"}}>\n          <div ref={dragRef} className=\"ContactTemplate\" style={{ opacity }}>\n            <div className=\"ContactTitleBackground\" style={{ backgroundColor: itemTitleColor }}>\n              <div className=\"ContactTitle\">{itemConfig.title}</div>\n            </div>\n            <div className=\"ContactPhotoFrame\">\n              <img className=\"ContactPhoto\" src={itemConfig.image} alt={itemConfig.title} />\n            </div>\n            <div className=\"ContactPhone\">{itemConfig.phone}</div>\n            <div className=\"ContactEmail\">{itemConfig.email}</div>\n            <div className=\"ContactDescription\">{itemConfig.description}</div>\n          </div>\n        </div>\n      )\n    }\n\n    class Sample extends Component {\n      constructor() {\n        super();\n\n        this.onRemoveItem = this.onRemoveItem.bind(this);\n        this.canDropItem = this.canDropItem.bind(this);\n        this.onMoveItem = this.onMoveItem.bind(this);\n\n        this.state = {\n          cursorItem: 0,\n          highlightItem: 0,\n          items: [\n            { id: 0, parent: null, description: \"Chief Executive Officer (CEO)\", email: \"davidalt@name.com\", image: \"/react/photos/q.png\", itemTitleColor: \"#4169e1\", phone: \"352-206-7599\", title: \"David Dalton\", label: \"David Dalton\" },\n            { id: 1, parent: 0, description: \"Co-Presidents, Platform Products & Services Division\", email: \"jeanwhit@name.com\", image: \"/react/photos/w.png\", phone: \"505-791-1689\", title: \"Jeanna White\", label: \"Jeanna White\" },\n            { id: 2, parent: 0, description: \"Sr. VP, Server & Tools Division\", email: \"jameholt@name.com\", image: \"/react/photos/e.png\", phone: \"262-215-7998\", title: \"James Holt\", label: \"James Holt\" },\n            { id: 3, parent: null, description: \"VP, Server & Tools Marketing and Solutions\", email: \"thomwill@name.com\", image: \"/react/photos/r.png\", phone: \"904-547-5342\", title: \"Thomas Williams\", label: \"Thomas Williams\" },\n            { id: 4, parent: 3, description: \"VP, Software & Enterprise Management Division\", email: \"sarakemp@name.com\", image: \"/react/photos/g.png\", phone: \"918-257-4218\", title: \"Sara Kemp\", label: \"Sara Kemp\" },\n            { id: 5, parent: 3, description: \"Sr. VP, Software Server System\", email: \"georduon@name.com\", image: \"/react/photos/x.png\", phone: \"434-406-2189\", title: \"George Duong\", label: \"George Duong\" }\n          ]\n        }\n      }\n\n      onMoveItem(parentid, itemid) {\n        const { items } = this.state;\n\n        this.setState({\n          cursorItem: itemid,\n          items: (items.map(item => {\n            if (item.id === itemid) {\n              return {\n                ...item,\n                parent: parentid\n              }\n            }\n            return item;\n          }))\n        })\n      }\n\n      canDropItem(parentid, itemid) {\n        const { items } = this.state;\n        const tree = this.getTree(items);\n        let result = parentid !== itemid;\n        tree.loopParents(this, parentid, function (id, node) {\n          if (id === itemid) {\n            result = false;\n            return true;\n          }\n        });\n        return result;\n      }\n\n      onRemoveItem(id) {\n        const { items } = this.state;\n\n        this.setState(this.getDeletedItems(items, [id]));\n      }\n\n      getDeletedItems(items = [], deletedItems = []) {\n        const tree = this.getTree(items);\n        const hash = deletedItems.reduce((agg, itemid) => {\n          agg.add(itemid.toString());\n          return agg;\n        }, new Set());\n        const cursorParent = this.getDeletedItemsParent(tree, deletedItems, hash);\n        const result = [];\n        tree.loopLevels(this, (nodeid, node) => {\n          if (hash.has(nodeid.toString())) {\n            return tree.SKIP;\n          }\n          result.push(node);\n        });\n\n        return {\n          items: result,\n          cursorItem: cursorParent\n        };\n      }\n\n      getDeletedItemsParent(tree, deletedItems, deletedHash) {\n        let result = null;\n        const lca = LCA(tree);\n        result = deletedItems.reduce((agg, itemid) => {\n          if (agg == null) {\n            agg = itemid;\n          } else {\n            agg = lca.getLowestCommonAncestor(agg, itemid);\n          }\n          return agg;\n        }, null);\n\n        if (deletedHash.has(result.toString())) {\n          result = tree.parentid(result);\n        }\n        return result;\n      }\n\n      getTree(items = []) {\n        const tree = Tree();\n\n        for (let index = 0; index < items.length; index += 1) {\n          const item = items[index];\n          tree.add(item.parent, item.id, item);\n        }\n\n        return tree;\n      }\n\n      render() {\n        const config = {\n          ...this.state,\n          pageFitMode: PageFitMode.None,\n\n          hasSelectorCheckbox: Enabled.True,\n          orientationType: OrientationType.Top,\n          defaultTemplateName: \"contactTemplate\",\n          templates: [{\n            name: \"contactTemplate\",\n            itemSize: { width: 220, height: 120 },\n            minimizedItemSize: { width: 3, height: 3 },\n            highlightPadding: { left: 2, top: 2, right: 2, bottom: 2 },\n            onItemRender: ({ context: itemConfig }) => {\n              return <NodeDragDropSource\n                itemConfig={itemConfig}\n                onRemoveItem={this.onRemoveItem}\n                canDropItem={this.canDropItem}\n                onDropItem={this.onMoveItem}\n              />;\n            }\n          }]\n        }\n        return <>\n          <div className=\"placeholder\" style={{ clear: 'both' }} >\n            <OrgDiagram centerOnCursor={true} config={config} />\n          </div>\n        </>;\n      }\n    }\n\n    return <DndProvider backend={HTML5Backend}>\n      <Sample />\n    </DndProvider>\n  }\n}\n\n\nexport default Container;\n"]},"metadata":{},"sourceType":"module"}