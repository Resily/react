{"ast":null,"code":"export default function Cache() {\n  this.threshold = 20;\n  this.m_visible = {};\n  this.m_invisible = {};\n}\n;\n\nCache.prototype.begin = function () {\n  var placeholder, type, index, control;\n\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          for (index = this.m_visible[placeholder][type].length - 1; index >= 0; index -= 1) {\n            control = this.m_visible[placeholder][type][index];\n            control.style.visibility = \"hidden\";\n            this.m_invisible[placeholder][type].push(control);\n          }\n\n          this.m_visible[placeholder][type].length = 0;\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.end = function () {\n  var placeholder, type, control;\n\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          control = null;\n\n          if (this.m_invisible[placeholder][type].length > this.threshold) {\n            while ((control = this.m_invisible[placeholder][type].pop()) !== undefined) {\n              control.parentNode.removeChild(control);\n            }\n          }\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.reset = function (placeholder, layer) {\n  placeholder = placeholder + \"-\" + layer;\n  var control = null,\n      type,\n      index;\n\n  for (type in this.m_visible[placeholder]) {\n    if (this.m_visible[placeholder].hasOwnProperty(type)) {\n      for (index = this.m_visible[placeholder][type].length - 1; index >= 0; index -= 1) {\n        control = this.m_visible[placeholder][type][index];\n        this.m_invisible[placeholder][type].push(control);\n        control.style.visibility = \"hidden\";\n      }\n\n      this.m_visible[placeholder][type].length = 0;\n    }\n  }\n};\n\nCache.prototype.clear = function () {\n  var placeholder, type, control;\n\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          control = null;\n\n          while ((control = this.m_visible[placeholder][type].pop()) !== undefined) {\n            control.parentNode.removeChild(control);\n          }\n\n          while ((control = this.m_invisible[placeholder][type].pop()) !== undefined) {\n            control.parentNode.removeChild(control);\n          }\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.get = function (placeholder, layer, type) {\n  placeholder = placeholder + \"-\" + layer;\n  var result = null;\n\n  if (this.m_visible[placeholder] === undefined) {\n    this.m_visible[placeholder] = {};\n    this.m_invisible[placeholder] = {};\n  }\n\n  if (this.m_visible[placeholder][type] === undefined) {\n    this.m_visible[placeholder][type] = [];\n    this.m_invisible[placeholder][type] = [];\n  }\n\n  result = this.m_invisible[placeholder][type].pop() || null;\n\n  if (result !== null) {\n    this.m_visible[placeholder][type].push(result);\n    result.style.visibility = \"inherit\";\n  }\n\n  return result;\n};\n\nCache.prototype.put = function (placeholder, layer, type, control) {\n  placeholder = placeholder + \"-\" + layer;\n  this.m_visible[placeholder][type].push(control);\n};","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/node_modules/basicprimitives/src/graphics/Cache.js"],"names":["Cache","threshold","m_visible","m_invisible","prototype","begin","placeholder","type","index","control","hasOwnProperty","length","style","visibility","push","end","pop","undefined","parentNode","removeChild","reset","layer","clear","get","result","put"],"mappings":"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","sourcesContent":["export default function Cache() {\n  this.threshold = 20;\n\n  this.m_visible = {};\n  this.m_invisible = {};\n};\n\nCache.prototype.begin = function () {\n  var placeholder,\n    type,\n    index,\n    control;\n\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          for (index = this.m_visible[placeholder][type].length - 1; index >= 0; index -= 1) {\n            control = this.m_visible[placeholder][type][index];\n            control.style.visibility = \"hidden\";\n            this.m_invisible[placeholder][type].push(control);\n          }\n          this.m_visible[placeholder][type].length = 0;\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.end = function () {\n  var placeholder,\n    type,\n    control;\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          control = null;\n          if (this.m_invisible[placeholder][type].length > this.threshold) {\n            while ((control = this.m_invisible[placeholder][type].pop()) !== undefined) {\n              control.parentNode.removeChild(control);\n            }\n          }\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.reset = function (placeholder, layer) {\n  placeholder = placeholder + \"-\" + layer;\n  var control = null,\n    type,\n    index;\n  for (type in this.m_visible[placeholder]) {\n    if (this.m_visible[placeholder].hasOwnProperty(type)) {\n      for (index = this.m_visible[placeholder][type].length - 1; index >= 0; index -= 1) {\n        control = this.m_visible[placeholder][type][index];\n        this.m_invisible[placeholder][type].push(control);\n        control.style.visibility = \"hidden\";\n      }\n      this.m_visible[placeholder][type].length = 0;\n    }\n  }\n};\n\nCache.prototype.clear = function () {\n  var placeholder,\n    type,\n    control;\n  for (placeholder in this.m_visible) {\n    if (this.m_visible.hasOwnProperty(placeholder)) {\n      for (type in this.m_visible[placeholder]) {\n        if (this.m_visible[placeholder].hasOwnProperty(type)) {\n          control = null;\n          while ((control = this.m_visible[placeholder][type].pop()) !== undefined) {\n            control.parentNode.removeChild(control);\n          }\n          while ((control = this.m_invisible[placeholder][type].pop()) !== undefined) {\n            control.parentNode.removeChild(control);\n          }\n        }\n      }\n    }\n  }\n};\n\nCache.prototype.get = function (placeholder, layer, type) {\n  placeholder = placeholder + \"-\" + layer;\n  var result = null;\n  if (this.m_visible[placeholder] === undefined) {\n    this.m_visible[placeholder] = {};\n    this.m_invisible[placeholder] = {};\n  }\n  if (this.m_visible[placeholder][type] === undefined) {\n    this.m_visible[placeholder][type] = [];\n    this.m_invisible[placeholder][type] = [];\n  }\n  result = this.m_invisible[placeholder][type].pop() || null;\n  if (result !== null) {\n    this.m_visible[placeholder][type].push(result);\n    result.style.visibility = \"inherit\";\n  }\n  return result;\n};\n\nCache.prototype.put = function (placeholder, layer, type, control) {\n  placeholder = placeholder + \"-\" + layer;\n  this.m_visible[placeholder][type].push(control);\n};"]},"metadata":{},"sourceType":"module"}