{"ast":null,"code":"import _objectSpread from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _assertThisInitialized from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _classCallCheck from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{OrgDiagram}from'../Diagrams';import{LCA,Tree,Colors,PageFitMode,Enabled,OrientationType}from'basicprimitives';import{DndProvider,DropTarget,DragSource}from'react-dnd';import{HTML5Backend}from'react-dnd-html5-backend';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Container=/*#__PURE__*/function(_Component){_inherits(Container,_Component);var _super=_createSuper(Container);function Container(){_classCallCheck(this,Container);return _super.apply(this,arguments);}_createClass(Container,[{key:\"render\",value:function render(){var ItemTypes={NODE:'node'};var Node=function Node(_ref){var itemConfig=_ref.itemConfig,isDragging=_ref.isDragging,connectDragSource=_ref.connectDragSource,canDrop=_ref.canDrop,isOver=_ref.isOver,connectDropTarget=_ref.connectDropTarget;var opacity=isDragging?0.4:1;var itemTitleColor=Colors.RoyalBlue;if(isOver){if(canDrop){itemTitleColor=\"green\";}else{itemTitleColor=\"red\";}}return connectDropTarget(connectDragSource(/*#__PURE__*/_jsxs(\"div\",{className:\"ContactTemplate\",style:{opacity:opacity},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitleBackground\",style:{backgroundColor:itemTitleColor},children:/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitle\",children:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhotoFrame\",children:/*#__PURE__*/_jsx(\"img\",{className:\"ContactPhoto\",src:itemConfig.image,alt:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhone\",children:itemConfig.phone}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactEmail\",children:itemConfig.email}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactDescription\",children:itemConfig.description})]})));};var NodeDragSource=DragSource(ItemTypes.NODE,{beginDrag:function beginDrag(_ref2){var itemConfig=_ref2.itemConfig;return{id:itemConfig.id};},endDrag:function endDrag(props,monitor){var onMoveItem=props.onMoveItem;var item=monitor.getItem();var dropResult=monitor.getDropResult();if(dropResult){onMoveItem(dropResult.id,item.id);}}},function(connect,monitor){return{connectDragSource:connect.dragSource(),isDragging:monitor.isDragging()};})(Node);var NodeDragDropSource=DropTarget(ItemTypes.NODE,{drop:function drop(_ref3){var itemConfig=_ref3.itemConfig;return{id:itemConfig.id};},canDrop:function canDrop(_ref4,monitor){var canDropItem=_ref4.canDropItem,itemConfig=_ref4.itemConfig;var _monitor$getItem=monitor.getItem(),id=_monitor$getItem.id;return canDropItem(itemConfig.id,id);}},function(connect,monitor){return{connectDropTarget:connect.dropTarget(),isOver:monitor.isOver(),canDrop:monitor.canDrop()};})(NodeDragSource);var Sample=/*#__PURE__*/function(_Component2){_inherits(Sample,_Component2);var _super2=_createSuper(Sample);function Sample(){var _this;_classCallCheck(this,Sample);_this=_super2.call(this);_this.onRemoveItem=_this.onRemoveItem.bind(_assertThisInitialized(_this));_this.canDropItem=_this.canDropItem.bind(_assertThisInitialized(_this));_this.onMoveItem=_this.onMoveItem.bind(_assertThisInitialized(_this));_this.state={cursorItem:0,highlightItem:0,items:[{id:0,parent:null,description:\"Chief Executive Officer (CEO)\",email:\"davidalt@name.com\",image:\"/react/photos/q.png\",itemTitleColor:\"#4169e1\",phone:\"352-206-7599\",title:\"David Dalton\",label:\"David Dalton\"},{id:1,parent:0,description:\"Co-Presidents, Platform Products & Services Division\",email:\"jeanwhit@name.com\",image:\"/react/photos/w.png\",phone:\"505-791-1689\",title:\"Jeanna White\",label:\"Jeanna White\"},{id:2,parent:0,description:\"Sr. VP, Server & Tools Division\",email:\"jameholt@name.com\",image:\"/react/photos/e.png\",phone:\"262-215-7998\",title:\"James Holt\",label:\"James Holt\"},{id:3,parent:null,description:\"VP, Server & Tools Marketing and Solutions\",email:\"thomwill@name.com\",image:\"/react/photos/r.png\",phone:\"904-547-5342\",title:\"Thomas Williams\",label:\"Thomas Williams\"},{id:4,parent:3,description:\"VP, Software & Enterprise Management Division\",email:\"sarakemp@name.com\",image:\"/react/photos/g.png\",phone:\"918-257-4218\",title:\"Sara Kemp\",label:\"Sara Kemp\"},{id:5,parent:3,description:\"Sr. VP, Software Server System\",email:\"georduon@name.com\",image:\"/react/photos/x.png\",phone:\"434-406-2189\",title:\"George Duong\",label:\"George Duong\"}]};return _this;}_createClass(Sample,[{key:\"onMoveItem\",value:function onMoveItem(parentid,itemid){var items=this.state.items;this.setState({cursorItem:itemid,items:items.map(function(item){if(item.id===itemid){return _objectSpread(_objectSpread({},item),{},{parent:parentid});}return item;})});}},{key:\"canDropItem\",value:function canDropItem(parentid,itemid){var items=this.state.items;var tree=this.getTree(items);var result=parentid!==itemid;tree.loopParents(this,parentid,function(id,node){if(id===itemid){result=false;return true;}});return result;}},{key:\"onRemoveItem\",value:function onRemoveItem(id){var items=this.state.items;this.setState(this.getDeletedItems(items,[id]));}},{key:\"getDeletedItems\",value:function getDeletedItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var deletedItems=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var tree=this.getTree(items);var hash=deletedItems.reduce(function(agg,itemid){agg.add(itemid.toString());return agg;},new Set());var cursorParent=this.getDeletedItemsParent(tree,deletedItems,hash);var result=[];tree.loopLevels(this,function(nodeid,node){if(hash.has(nodeid.toString())){return tree.SKIP;}result.push(node);});return{items:result,cursorItem:cursorParent};}},{key:\"getDeletedItemsParent\",value:function getDeletedItemsParent(tree,deletedItems,deletedHash){var result=null;var lca=LCA(tree);result=deletedItems.reduce(function(agg,itemid){if(agg==null){agg=itemid;}else{agg=lca.getLowestCommonAncestor(agg,itemid);}return agg;},null);if(deletedHash.has(result.toString())){result=tree.parentid(result);}return result;}},{key:\"getTree\",value:function getTree(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var tree=Tree();for(var index=0;index<items.length;index+=1){var item=items[index];tree.add(item.parent,item.id,item);}return tree;}},{key:\"render\",value:function render(){var _this2=this;var config=_objectSpread(_objectSpread({},this.state),{},{pageFitMode:PageFitMode.None,hasSelectorCheckbox:Enabled.True,orientationType:OrientationType.Top,defaultTemplateName:\"contactTemplate\",templates:[{name:\"contactTemplate\",itemSize:{width:220,height:120},minimizedItemSize:{width:3,height:3},highlightPadding:{left:2,top:2,right:2,bottom:2},onItemRender:function onItemRender(_ref5){var itemConfig=_ref5.context;return/*#__PURE__*/_jsx(NodeDragDropSource,{itemConfig:itemConfig,onRemoveItem:_this2.onRemoveItem,canDropItem:_this2.canDropItem,onMoveItem:_this2.onMoveItem});}}]});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"placeholder\",style:{clear:'both'},children:/*#__PURE__*/_jsx(OrgDiagram,{centerOnCursor:true,config:config})})});}}]);return Sample;}(Component);return/*#__PURE__*/_jsx(DndProvider,{backend:HTML5Backend,children:/*#__PURE__*/_jsx(Sample,{})});}}]);return Container;}(Component);export default Container;","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/src/Samples/DragNDrop.js"],"names":["React","Component","OrgDiagram","LCA","Tree","Colors","PageFitMode","Enabled","OrientationType","DndProvider","DropTarget","DragSource","HTML5Backend","Container","ItemTypes","NODE","Node","itemConfig","isDragging","connectDragSource","canDrop","isOver","connectDropTarget","opacity","itemTitleColor","RoyalBlue","backgroundColor","title","image","phone","email","description","NodeDragSource","beginDrag","id","endDrag","props","monitor","onMoveItem","item","getItem","dropResult","getDropResult","connect","dragSource","NodeDragDropSource","drop","canDropItem","dropTarget","Sample","onRemoveItem","bind","state","cursorItem","highlightItem","items","parent","label","parentid","itemid","setState","map","tree","getTree","result","loopParents","node","getDeletedItems","deletedItems","hash","reduce","agg","add","toString","Set","cursorParent","getDeletedItemsParent","loopLevels","nodeid","has","SKIP","push","deletedHash","lca","getLowestCommonAncestor","index","length","config","pageFitMode","None","hasSelectorCheckbox","True","orientationType","Top","defaultTemplateName","templates","name","itemSize","width","height","minimizedItemSize","highlightPadding","left","top","right","bottom","onItemRender","context","clear"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { OrgDiagram } from '../Diagrams';\nimport { LCA, Tree, Colors, PageFitMode, Enabled, OrientationType } from 'basicprimitives';\nimport { DndProvider, DropTarget, DragSource } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nclass Container extends Component {\n  render() {\n    const ItemTypes = {\n      NODE: 'node'\n    }\n\n    const Node = ({ itemConfig, isDragging, connectDragSource, canDrop, isOver, connectDropTarget }) => {\n      const opacity = isDragging ? 0.4 : 1\n      let itemTitleColor = Colors.RoyalBlue;\n      if (isOver) {\n        if (canDrop) {\n          itemTitleColor = \"green\";\n        } else {\n          itemTitleColor = \"red\";\n        }\n      }\n\n      return connectDropTarget(connectDragSource(\n        <div className=\"ContactTemplate\" style={{ opacity }}>\n          <div className=\"ContactTitleBackground\" style={{ backgroundColor: itemTitleColor }}>\n            <div className=\"ContactTitle\">{itemConfig.title}</div>\n          </div>\n          <div className=\"ContactPhotoFrame\">\n            <img className=\"ContactPhoto\" src={itemConfig.image} alt={itemConfig.title} />\n          </div>\n          <div className=\"ContactPhone\">{itemConfig.phone}</div>\n          <div className=\"ContactEmail\">{itemConfig.email}</div>\n          <div className=\"ContactDescription\">{itemConfig.description}</div>\n        </div>\n      ))\n    }\n    const NodeDragSource = DragSource(\n      ItemTypes.NODE,\n      {\n        beginDrag: ({ itemConfig }) => ({ id: itemConfig.id }),\n        endDrag(props, monitor) {\n          const { onMoveItem } = props;\n          const item = monitor.getItem()\n          const dropResult = monitor.getDropResult()\n          if (dropResult) {\n            onMoveItem(dropResult.id, item.id);\n          }\n        },\n      },\n      (connect, monitor) => ({\n        connectDragSource: connect.dragSource(),\n        isDragging: monitor.isDragging(),\n      }),\n    )(Node);\n\n    const NodeDragDropSource = DropTarget(\n      ItemTypes.NODE,\n      {\n        drop: ({ itemConfig }) => ({ id: itemConfig.id }),\n        canDrop: ({ canDropItem, itemConfig }, monitor) => {\n          const { id } = monitor.getItem();\n          return canDropItem(itemConfig.id, id);\n        },\n      },\n      (connect, monitor) => ({\n        connectDropTarget: connect.dropTarget(),\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    )(NodeDragSource)\n\n    class Sample extends Component {\n      constructor() {\n        super();\n\n        this.onRemoveItem = this.onRemoveItem.bind(this);\n        this.canDropItem = this.canDropItem.bind(this);\n        this.onMoveItem = this.onMoveItem.bind(this);\n\n        this.state = {\n          cursorItem: 0,\n          highlightItem: 0,\n          items: [\n            { id: 0, parent: null, description: \"Chief Executive Officer (CEO)\", email: \"davidalt@name.com\", image: \"/react/photos/q.png\", itemTitleColor: \"#4169e1\", phone: \"352-206-7599\", title: \"David Dalton\", label: \"David Dalton\" },\n            { id: 1, parent: 0, description: \"Co-Presidents, Platform Products & Services Division\", email: \"jeanwhit@name.com\", image: \"/react/photos/w.png\", phone: \"505-791-1689\", title: \"Jeanna White\", label: \"Jeanna White\" },\n            { id: 2, parent: 0, description: \"Sr. VP, Server & Tools Division\", email: \"jameholt@name.com\", image: \"/react/photos/e.png\", phone: \"262-215-7998\", title: \"James Holt\", label: \"James Holt\" },\n            { id: 3, parent: null, description: \"VP, Server & Tools Marketing and Solutions\", email: \"thomwill@name.com\", image: \"/react/photos/r.png\", phone: \"904-547-5342\", title: \"Thomas Williams\", label: \"Thomas Williams\" },\n            { id: 4, parent: 3, description: \"VP, Software & Enterprise Management Division\", email: \"sarakemp@name.com\", image: \"/react/photos/g.png\", phone: \"918-257-4218\", title: \"Sara Kemp\", label: \"Sara Kemp\" },\n            { id: 5, parent: 3, description: \"Sr. VP, Software Server System\", email: \"georduon@name.com\", image: \"/react/photos/x.png\", phone: \"434-406-2189\", title: \"George Duong\", label: \"George Duong\" }\n          ]\n        }\n      }\n\n      onMoveItem(parentid, itemid) {\n        const { items } = this.state;\n\n        this.setState({\n          cursorItem: itemid,\n          items: (items.map(item => {\n            if (item.id === itemid) {\n              return {\n                ...item,\n                parent: parentid\n              }\n            }\n            return item;\n          }))\n        })\n      }\n\n      canDropItem(parentid, itemid) {\n        const { items } = this.state;\n        const tree = this.getTree(items);\n        let result = parentid !== itemid;\n        tree.loopParents(this, parentid, function (id, node) {\n          if (id === itemid) {\n            result = false;\n            return true;\n          }\n        });\n        return result;\n      }\n\n      onRemoveItem(id) {\n        const { items } = this.state;\n\n        this.setState(this.getDeletedItems(items, [id]));\n      }\n\n      getDeletedItems(items = [], deletedItems = []) {\n        const tree = this.getTree(items);\n        const hash = deletedItems.reduce((agg, itemid) => {\n          agg.add(itemid.toString());\n          return agg;\n        }, new Set());\n        const cursorParent = this.getDeletedItemsParent(tree, deletedItems, hash);\n        const result = [];\n        tree.loopLevels(this, (nodeid, node) => {\n          if (hash.has(nodeid.toString())) {\n            return tree.SKIP;\n          }\n          result.push(node);\n        });\n\n        return {\n          items: result,\n          cursorItem: cursorParent\n        };\n      }\n\n      getDeletedItemsParent(tree, deletedItems, deletedHash) {\n        let result = null;\n        const lca = LCA(tree);\n        result = deletedItems.reduce((agg, itemid) => {\n          if (agg == null) {\n            agg = itemid;\n          } else {\n            agg = lca.getLowestCommonAncestor(agg, itemid);\n          }\n          return agg;\n        }, null);\n\n        if (deletedHash.has(result.toString())) {\n          result = tree.parentid(result);\n        }\n        return result;\n      }\n\n      getTree(items = []) {\n        const tree = Tree();\n\n        for (let index = 0; index < items.length; index += 1) {\n          const item = items[index];\n          tree.add(item.parent, item.id, item);\n        }\n\n        return tree;\n      }\n\n      render() {\n        const config = {\n          ...this.state,\n          pageFitMode: PageFitMode.None,\n\n          hasSelectorCheckbox: Enabled.True,\n          orientationType: OrientationType.Top,\n          defaultTemplateName: \"contactTemplate\",\n          templates: [{\n            name: \"contactTemplate\",\n            itemSize: { width: 220, height: 120 },\n            minimizedItemSize: { width: 3, height: 3 },\n            highlightPadding: { left: 2, top: 2, right: 2, bottom: 2 },\n            onItemRender: ({ context: itemConfig }) => {\n              return <NodeDragDropSource\n                itemConfig={itemConfig}\n                onRemoveItem={this.onRemoveItem}\n                canDropItem={this.canDropItem}\n                onMoveItem={this.onMoveItem}\n              />;\n            }\n          }]\n        }\n        return <>\n          <div className=\"placeholder\" style={{ clear: 'both' }} >\n            <OrgDiagram centerOnCursor={true} config={config} />\n          </div>\n        </>;\n      }\n    }\n\n    return <DndProvider backend={HTML5Backend}>\n      <Sample />\n    </DndProvider>\n  }\n}\n\n\nexport default Container;\n"]},"metadata":{},"sourceType":"module"}