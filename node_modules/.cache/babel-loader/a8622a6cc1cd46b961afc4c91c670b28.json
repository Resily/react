{"ast":null,"code":"import _objectSpread from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{getFixOfPixelAlignment,getInnerSize,getElementOffset,OrientationType,Rect,Size,Point}from'basicprimitives';import Graphics from'./Graphics';import{AnnotationLabelTemplate,ButtonsTemplate,CheckBoxTemplate,CursorTemplate,DotHighlightTemplate,GroupTitleTemplate,HighlightTemplate,ItemTemplate,UserTemplate,LabelAnnotationTemplate,LevelTitleTemplate,LevelBackgroundTemplate}from'./Templates';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var BaseDiagram=/*#__PURE__*/function(_Component){_inherits(BaseDiagram,_Component);var _super=_createSuper(BaseDiagram);function BaseDiagram(props,TaskManagerFactory,EventArgs){var _this;_classCallCheck(this,BaseDiagram);_this=_super.call(this,props);_this.TaskManagerFactory=TaskManagerFactory;_this.EventArgs=EventArgs;var config=props.config,centerOnCursor=props.centerOnCursor;var highlightItem=config.highlightItem,cursorItem=config.cursorItem,selectedItems=config.selectedItems;_this.state={config:config,viewportSize:{width:0,height:0},contentPosition:{x:0,y:0},centerOnCursor:centerOnCursor,highlightItem:highlightItem,cursorItem:cursorItem,selectedItems:(selectedItems||[]).slice()};var viewportSize=_this.state.viewportSize;_this.onRefreshViewport=_this.onRefreshViewport.bind(_assertThisInitialized(_this));_this.onSizeChanged=_this.onSizeChanged.bind(_assertThisInitialized(_this));_this.onScroll=_this.onScroll.bind(_assertThisInitialized(_this));_this.onMouseMove=_this.onMouseMove.bind(_assertThisInitialized(_this));_this.onClick=_this.onClick.bind(_assertThisInitialized(_this));_this.onCheckboxChange=_this.onCheckboxChange.bind(_assertThisInitialized(_this));_this.onKeyDown=_this.onKeyDown.bind(_assertThisInitialized(_this));_this.onFrameClick=_this.onFrameClick.bind(_assertThisInitialized(_this));_this.onFrameMouseMove=_this.onFrameMouseMove.bind(_assertThisInitialized(_this));_this.getOptions=_this.getOptions.bind(_assertThisInitialized(_this));_this.getGraphics=_this.getGraphics.bind(_assertThisInitialized(_this));_this.getLayout=_this.getLayout.bind(_assertThisInitialized(_this));_this.setLayout=_this.setLayout.bind(_assertThisInitialized(_this));_this.getEventArgs=_this.getEventArgs.bind(_assertThisInitialized(_this));_this.centerOnCursor=_this.centerOnCursor.bind(_assertThisInitialized(_this));_this.onItemRender=_this.onItemRender.bind(_assertThisInitialized(_this));_this.onHighlightRender=_this.onHighlightRender.bind(_assertThisInitialized(_this));_this.onCursorRender=_this.onCursorRender.bind(_assertThisInitialized(_this));_this.controlPanelRef=/*#__PURE__*/React.createRef();_this.frameMousePanelRef=/*#__PURE__*/React.createRef();_this.framePlaceholderRef=/*#__PURE__*/React.createRef();_this.titlesMousePanelRef=/*#__PURE__*/React.createRef();_this.titlesPlaceholderRef=/*#__PURE__*/React.createRef();_this.scrollPanelRef=/*#__PURE__*/React.createRef();_this.mousePanelRef=/*#__PURE__*/React.createRef();_this.placeholderRef=/*#__PURE__*/React.createRef();_this.calloutPlaceholderRef=/*#__PURE__*/React.createRef();_this.layoutOptions={};_this.templatesHash={};_this.graphics=new Graphics(viewportSize);_this.templates={AnnotationLabelTemplate:AnnotationLabelTemplate,ButtonsTemplate:ButtonsTemplate,CheckBoxTemplate:CheckBoxTemplate,CursorTemplate:CursorTemplate,DotHighlightTemplate:DotHighlightTemplate,GroupTitleTemplate:GroupTitleTemplate,HighlightTemplate:HighlightTemplate,ItemTemplate:ItemTemplate,UserTemplate:UserTemplate,LabelAnnotationTemplate:LabelAnnotationTemplate,LevelTitleTemplate:LevelTitleTemplate,LevelBackgroundTemplate:LevelBackgroundTemplate};_this.tasks=TaskManagerFactory(_this.getOptions,_this.getGraphics,_this.getLayout,_this.setLayout,_this.templates);return _this;}_createClass(BaseDiagram,[{key:\"componentDidMount\",value:function componentDidMount(){// The following code is ResizeObserver Polyfill\n// It is added to the rendered page to track size changes of control placeholder\n// npm install resize-observer-polyfill --save-dev\nrequire('resize-observer-polyfill/dist/ResizeObserver.global');this.observer=new ResizeObserver(this.onSizeChanged);this.observer.observe(this.controlPanelRef.current);this.centerOnCursor();this.fixPixelAlignment();}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){// destroy timer\nclearTimeout(this.timer);this.timer=null;// destroy observer\nthis.observer.disconnect();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.centerOnCursor();}},{key:\"centerOnCursor\",value:function centerOnCursor(){var centerOnCursor=this.state.centerOnCursor;if(centerOnCursor){/* scroll to offset */var centerOnCursorTask=this.tasks.getTask(\"CenterOnCursorTask\");var placeholderOffset=centerOnCursorTask.getPlaceholderOffset();var scrollLeft=placeholderOffset.x,scrollTop=placeholderOffset.y;this.scrollPanelRef.current.scrollLeft=scrollLeft;this.scrollPanelRef.current.scrollTop=scrollTop;}}},{key:\"fixPixelAlignment\",value:function fixPixelAlignment(){var current=this.controlPanelRef.current;var pixelAlignmentFix=getFixOfPixelAlignment(current);current.style.marginLeft=pixelAlignmentFix.width+\"px\";current.style.marginTop=pixelAlignmentFix.height+\"px\";}},{key:\"onSizeChanged\",value:function onSizeChanged(){var _getInnerSize=getInnerSize(this.controlPanelRef.current),width=_getInnerSize.width,height=_getInnerSize.height;this.setState({viewportSize:{width:width,height:height},centerOnCursor:true});}},{key:\"onScroll\",value:function onScroll(){if(this.timer==null){this.timer=setTimeout(this.onRefreshViewport,200);}}},{key:\"onRefreshViewport\",value:function onRefreshViewport(){clearTimeout(this.timer);this.timer=null;var _this$scrollPanelRef$=this.scrollPanelRef.current,scrollTop=_this$scrollPanelRef$.scrollTop,scrollLeft=_this$scrollPanelRef$.scrollLeft;this.setState({contentPosition:{x:Math.floor(scrollLeft),y:Math.floor(scrollTop)},centerOnCursor:false});}},{key:\"onFrameMouseMove\",value:function onFrameMouseMove(event){var placeholderOffset=getElementOffset(this.frameMousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=this.tasks.getTask(\"ProjectItemsToFrameTask\"),highlightItemOptionTask=this.tasks.getTask(\"HighlightItemOptionTask\");if(highlightItemOptionTask.hasHighlightEnabled()){var itemId=projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());this.setHighlightItem(event,itemId);}}},{key:\"onFrameClick\",value:function onFrameClick(event){var placeholderOffset=getElementOffset(this.frameMousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,projectItemsToFrameTask=this.tasks.getTask(\"ProjectItemsToFrameTask\"),cursorItemOptionTask=this.tasks.getTask(\"CursorItemOptionTask\"),highlightItemOptionTask=this.tasks.getTask(\"HighlightItemOptionTask\"),newCursorItemId=projectItemsToFrameTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());if(newCursorItemId!==null){if(cursorItemOptionTask.hasCursorEnabled()){this.setCursorItem(event,newCursorItemId);this.controlPanelRef.current.focus();}}}},{key:\"onMouseMove\",value:function onMouseMove(event){var placeholderOffset=getElementOffset(this.mousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=this.tasks.getTask(\"CreateTransformTask\"),highlightItemOptionTask=this.tasks.getTask(\"HighlightItemOptionTask\");if(highlightItemOptionTask.hasHighlightEnabled()){var itemId=createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius());this.setHighlightItem(event,itemId);}}},{key:\"getEventArgs\",value:function getEventArgs(oldTreeItemId,newTreeItemId,name){var result=new this.EventArgs(),combinedContextsTask=this.tasks.getTask(\"CombinedContextsTask\"),alignDiagramTask=this.tasks.getTask(\"AlignDiagramTask\"),oldItemConfig=combinedContextsTask.getConfig(oldTreeItemId),newItemConfig=combinedContextsTask.getConfig(newTreeItemId),itemPosition,offset,panelOffset;if(oldItemConfig&&oldItemConfig.id!=null){result.oldContext=oldItemConfig;}if(newItemConfig&&newItemConfig.id!=null){result.context=newItemConfig;if(newItemConfig.parent!==null){result.parentItem=combinedContextsTask.getConfig(newItemConfig.parent);}panelOffset=getElementOffset(this.mousePanelRef.current);offset=getElementOffset(this.scrollPanelRef.current);itemPosition=alignDiagramTask.getItemPosition(newTreeItemId);result.position=new Rect(itemPosition.actualPosition).translate(panelOffset.left,panelOffset.top).translate(-offset.left,-offset.top);}if(name!=null){result.name=name;}return result;}},{key:\"setHighlightItem\",value:function setHighlightItem(event,newHighlightItemId){var eventArgs,cancel=false;var _this$props=this.props,onHighlightChanging=_this$props.onHighlightChanging,onHighlightChanged=_this$props.onHighlightChanged;var highlightItem=this.state.highlightItem;if(newHighlightItemId!==highlightItem){eventArgs=this.getEventArgs(highlightItem,newHighlightItemId);if(onHighlightChanging!=null){if(!onHighlightChanging(event,eventArgs)){cancel=true;this.setState({highlightItem:newHighlightItemId});}}else{this.setState({highlightItem:newHighlightItemId});};if(!cancel){if(onHighlightChanged!=null){onHighlightChanged(event,eventArgs);}}}}},{key:\"setCursorItem\",value:function setCursorItem(event,newCursorItemId){var eventArgs,cancel=false;var _this$props2=this.props,onCursorChanging=_this$props2.onCursorChanging,onCursorChanged=_this$props2.onCursorChanged;var cursorItem=this.state.cursorItem;if(newCursorItemId!==cursorItem){eventArgs=this.getEventArgs(cursorItem,newCursorItemId);if(onCursorChanging!=null){if(!onCursorChanging(event,eventArgs)){cancel=true;this.setState({cursorItem:newCursorItemId,centerOnCursor:true});}}else{this.setState({cursorItem:newCursorItemId,centerOnCursor:true});}if(!cancel){if(onCursorChanged!=null){onCursorChanged(event,eventArgs);}}}}},{key:\"onClick\",value:function onClick(event){var placeholderOffset=getElementOffset(this.mousePanelRef.current),x=event.pageX-placeholderOffset.left,y=event.pageY-placeholderOffset.top,createTransformTask=this.tasks.getTask(\"CreateTransformTask\"),cursorItemOptionTask=this.tasks.getTask(\"CursorItemOptionTask\"),highlightItemOptionTask=this.tasks.getTask(\"HighlightItemOptionTask\"),newCursorItemId=createTransformTask.getTreeItemForMousePosition(x,y,highlightItemOptionTask.getGravityRadius()),target;target=event.target;if(newCursorItemId!==null){if(target.getAttribute(\"name\")===\"checkbox\"||target.getAttribute(\"name\")===\"selectiontext\"){//ignore jslint\n}else{if(cursorItemOptionTask.hasCursorEnabled()){this.setCursorItem(event,newCursorItemId);this.controlPanelRef.current.focus();}}}}},{key:\"onCheckboxChange\",value:function onCheckboxChange(event){var _this$props3=this.props,onSelectionChanging=_this$props3.onSelectionChanging,onSelectionChanged=_this$props3.onSelectionChanged;var selectedItems=this.state.selectedItems;var newSelectedItems=[];var target=event.target;var itemid=target.getAttribute(\"data-id\");var checked=event.target.checked;var cancel=false;if(itemid!=null){if(checked){newSelectedItems=[].concat(_toConsumableArray(selectedItems),[itemid]);}else{// eslint-disable-next-line\nnewSelectedItems=selectedItems.filter(function(id){return id!=itemid;});// User type may not mach string value in data attribute\n}if(onSelectionChanging!=null){cancel=onSelectionChanging(event,selectedItems,newSelectedItems);}if(!cancel){this.setState({selectedItems:newSelectedItems});if(onSelectionChanged!=null){onSelectionChanged(event,selectedItems,newSelectedItems);}}}}},{key:\"onKeyDown\",value:function onKeyDown(event){var highlightItemTask=this.tasks.getTask(\"HighlightItemTask\"),highlightItemOptionTask=this.tasks.getTask(\"HighlightItemOptionTask\"),cursorItemTask=this.tasks.getTask(\"CursorItemTask\"),cursorItemOptionTask=this.tasks.getTask(\"CursorItemOptionTask\"),alignDiagramTask=this.tasks.getTask('AlignDiagramTask'),createTransformTask=this.tasks.getTask('CreateTransformTask'),transform=createTransformTask.getTransform(),navigationItem=null,newNavigationItem,direction=null,accepted;if(highlightItemOptionTask.hasHighlightEnabled()&&cursorItemOptionTask.hasCursorEnabled()){navigationItem=highlightItemTask.getHighlightTreeItem();if(navigationItem===null){navigationItem=cursorItemTask.getCursorTreeItem();}}else if(highlightItemOptionTask.hasHighlightEnabled()){navigationItem=highlightItemTask.getHighlightTreeItem();}else if(cursorItemOptionTask.hasCursorEnabled()){navigationItem=cursorItemTask.getCursorTreeItem();}if(navigationItem!=null){switch(event.which){case 13:/*Enter*/if(cursorItemOptionTask.hasCursorEnabled()){this.setCursorItem(event,navigationItem);event.preventDefault();this.controlPanelRef.current.focus();}break;case 40:/*Down*/direction=OrientationType.Bottom;break;case 38:/*Up*/direction=OrientationType.Top;break;case 37:/*Left*/direction=OrientationType.Left;break;case 39:/*Right*/direction=OrientationType.Right;break;default:break;}if(direction!=null){accepted=false;while(!accepted){accepted=true;direction=transform.getOrientation(direction);newNavigationItem=alignDiagramTask.getNextItem(navigationItem,direction);if(newNavigationItem!=null){event.preventDefault();if(highlightItemOptionTask.hasHighlightEnabled()){this.setHighlightItem(event,newNavigationItem);}else if(cursorItemOptionTask.hasCursorEnabled()){this.setCursorItem(event,newNavigationItem);}}}this.controlPanelRef.current.focus();}}}},{key:\"onItemRender\",value:function onItemRender(data){var templateName=data.templateName;var template=this.templatesHash[templateName];return template.onItemRender(data);}},{key:\"onHighlightRender\",value:function onHighlightRender(data){var templateName=data.templateName;var template=this.templatesHash[templateName];return template.onHighlightRender(data);}},{key:\"onCursorRender\",value:function onCursorRender(data){var templateName=data.templateName;var template=this.templatesHash[templateName];return template.onCursorRender(data);}},{key:\"getOptions\",value:function getOptions(){var config=this.props.config;var templates=config.templates||[];var effectiveTemplates=templates.map(function(template){var onItemRender=template.onItemRender,onHighlightRender=template.onHighlightRender,onCursorRender=template.onCursorRender;return _objectSpread(_objectSpread({},template),{},{itemTemplate:!onItemRender?null:\"<p>This template is not being used in React</p>\",highlightTemplate:!onHighlightRender?null:\"<p>This template is not being used in React</p>\",cursorTemplate:!onCursorRender?null:\"<p>This template is not being used in React</p>\"});});this.templatesHash=templates.reduce(function(agg,template){var name=template.name;agg[name]=template;return agg;},{});var _this$state=this.state,highlightItem=_this$state.highlightItem,cursorItem=_this$state.cursorItem,selectedItems=_this$state.selectedItems;return _objectSpread(_objectSpread({},config),{},{templates:effectiveTemplates,highlightItem:highlightItem,cursorItem:cursorItem,selectedItems:selectedItems,onItemRender:this.onItemRender,onCursorRender:this.onCursorRender,onHighlightRender:this.onHighlightRender});}},{key:\"getGraphics\",value:function getGraphics(){return this.graphics;}},{key:\"getLayout\",value:function getLayout(){var _this$state2=this.state,centerOnCursor=_this$state2.centerOnCursor,viewportSize=_this$state2.viewportSize,contentPosition=_this$state2.contentPosition;return{forceCenterOnCursor:centerOnCursor,scrollPanelSize:new Size(viewportSize),placeholderOffset:new Point(contentPosition)};}},{key:\"setLayout\",value:function setLayout(layoutOptions){var autoSize=layoutOptions.autoSize,controlSize=layoutOptions.controlSize,scale=layoutOptions.scale,frameMousePanelRect=layoutOptions.frameMousePanelRect,framePlaceholderSize=layoutOptions.framePlaceholderSize,titlesMousePanelRect=layoutOptions.titlesMousePanelRect,titlesPlaceholderSize=layoutOptions.titlesPlaceholderSize,scrollPanelRect=layoutOptions.scrollPanelRect,mousePanelSize=layoutOptions.mousePanelSize,placeholderSize=layoutOptions.placeholderSize;this.layoutOptions={autoSize:autoSize,controlSize:new Size(controlSize),scale:scale,frameMousePanelRect:new Rect(frameMousePanelRect),framePlaceholderSize:new Size(framePlaceholderSize),titlesMousePanelRect:new Rect(titlesMousePanelRect),titlesPlaceholderSize:new Size(titlesPlaceholderSize),scrollPanelRect:new Rect(scrollPanelRect),mousePanelSize:new Size(mousePanelSize),placeholderSize:new Size(placeholderSize)};}},{key:\"render\",value:function render(){var graphics=this.graphics;this.tasks.process('OptionsTask',null,false);var _this$graphics$placeh=this.graphics.placeholders,placeholder=_this$graphics$placeh.placeholder,calloutplaceholder=_this$graphics$placeh.calloutplaceholder,frameplaceholder=_this$graphics$placeh.frameplaceholder,titlesplaceholder=_this$graphics$placeh.titlesplaceholder;var placeholderRectCSS=placeholder.rect.getCSS();var _this$layoutOptions=this.layoutOptions,autoSize=_this$layoutOptions.autoSize,controlSize=_this$layoutOptions.controlSize,scale=_this$layoutOptions.scale,frameMousePanelRect=_this$layoutOptions.frameMousePanelRect,titlesMousePanelRect=_this$layoutOptions.titlesMousePanelRect,scrollPanelRect=_this$layoutOptions.scrollPanelRect,mousePanelSize=_this$layoutOptions.mousePanelSize;/* set CSS scale of content */var scaletext=\"scale(\"+scale+\",\"+scale+\")\";return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{/* root control panel */ref:this.controlPanelRef,onKeyDown:this.onKeyDown,style:_objectSpread({position:\"relative\",overflow:\"hidden\",top:\"0px\",left:\"0px\",width:\"100%\",height:\"100%\",padding:\"0px\",marginBottom:\"0px\",marginRight:\"0px\"},autoSize?controlSize.getCSS():{}),tabIndex:\"0\",children:[frameplaceholder&&/*#__PURE__*/_jsx(\"div\",{ref:this.frameMousePanelRef,onMouseMove:this.onFrameMouseMove,onClick:this.onFrameClick,style:_objectSpread({position:\"absolute\",overflow:\"hidden\"},frameMousePanelRect.getCSS()),children:/*#__PURE__*/_jsx(\"div\",{ref:this.framePlaceholderRef,style:_objectSpread(_objectSpread({},frameplaceholder.rect.getCSS()),{},{position:\"absolute\",overflow:\"hidden\",\"transformOrigin\":\"0 0\",\"transform\":scaletext,\"msTransform\":scaletext,/* IE 9 */\"WebkitTransform\":scaletext,/* Safari and Chrome */\"OTransform\":scaletext,/* Opera */\"MozTransform\":scaletext/* Firefox */}),children:graphics.map(this,\"frameplaceholder\",function(layerKey,elements){return/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",overflow:\"visible\",left:\"0px\",top:\"0px\"},children:elements},layerKey);})})}),titlesplaceholder&&/*#__PURE__*/_jsx(\"div\",{ref:this.titlesMousePanelRef,onMouseMove:this.onFrameMouseMove,onClick:this.onFrameClick,style:_objectSpread({position:\"absolute\",overflow:\"hidden\"},titlesMousePanelRect.getCSS()),children:/*#__PURE__*/_jsx(\"div\",{ref:this.titlesMousePanelRef,style:_objectSpread(_objectSpread({},titlesplaceholder.rect.getCSS()),{},{position:\"absolute\",overflow:\"hidden\",\"transformOrigin\":\"0 0\",\"transform\":scaletext,\"msTransform\":scaletext,/* IE 9 */\"WebkitTransform\":scaletext,/* Safari and Chrome */\"OTransform\":scaletext,/* Opera */\"MozTransform\":scaletext/* Firefox */}),children:graphics.map(this,\"titlesplaceholder\",function(layerKey,elements){return/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",overflow:\"visible\",left:\"0px\",top:\"0px\"},children:elements},layerKey);})})}),/*#__PURE__*/_jsx(\"div\",{ref:this.scrollPanelRef,onScroll:this.onScroll,style:_objectSpread(_objectSpread({position:\"absolute\",overflow:\"auto\",WebkitOverflowScrolling:\"touch\"},scrollPanelRect.getCSS()),{},{border:scrollPanelRect.x>0?\"1px dotted #dddddd\":\"\"}),children:/*#__PURE__*/_jsx(\"div\",{ref:this.mousePanelRef,onMouseMove:this.onMouseMove,onClick:this.onClick,onChange:this.onCheckboxChange,style:_objectSpread({position:\"absolute\",overflow:\"hidden\"},mousePanelSize.getCSS()),children:/*#__PURE__*/_jsxs(\"div\",{ref:this.placeholderRef,style:_objectSpread(_objectSpread({},placeholderRectCSS),{},{position:\"absolute\",overflow:\"hidden\",\"transformOrigin\":\"0 0\",\"transform\":scaletext,\"msTransform\":scaletext,/* IE 9 */\"WebkitTransform\":scaletext,/* Safari and Chrome */\"OTransform\":scaletext,/* Opera */\"MozTransform\":scaletext/* Firefox */}),children:[graphics.map(this,\"placeholder\",function(layerKey,elements){return/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",overflow:\"visible\",left:\"0px\",top:\"0px\"},children:elements},layerKey);}),calloutplaceholder&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",overflow:\"visible\",left:calloutplaceholder.rect.x+\"px\",top:calloutplaceholder.rect.y+\"px\"},children:graphics.map(this,\"calloutplaceholder\",function(layerKey,elements){return/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",overflow:\"visible\"},children:elements},layerKey);})},\"Callout\")]})})})]})});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(nextProps,state){var nextConfig=nextProps.config,centerOnCursor=nextProps.centerOnCursor;var config=state.config;if(config!==nextConfig){var highlightItem=nextConfig.highlightItem,cursorItem=nextConfig.cursorItem,selectedItems=nextConfig.selectedItems;return{config:nextConfig,highlightItem:highlightItem,cursorItem:cursorItem,selectedItems:(selectedItems||[]).slice(),centerOnCursor:centerOnCursor};}return null;}}]);return BaseDiagram;}(Component);BaseDiagram.defaultProps={centerOnCursor:true,onHighlightChanging:null,onHighlightChanged:null,onCursorChanging:null,onCursorChanged:null,onSelectionChanging:null,onSelectionChanged:null};export default BaseDiagram;","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/src/Diagrams/BaseDiagram.js"],"names":["React","Component","getFixOfPixelAlignment","getInnerSize","getElementOffset","OrientationType","Rect","Size","Point","Graphics","AnnotationLabelTemplate","ButtonsTemplate","CheckBoxTemplate","CursorTemplate","DotHighlightTemplate","GroupTitleTemplate","HighlightTemplate","ItemTemplate","UserTemplate","LabelAnnotationTemplate","LevelTitleTemplate","LevelBackgroundTemplate","BaseDiagram","props","TaskManagerFactory","EventArgs","config","centerOnCursor","highlightItem","cursorItem","selectedItems","state","viewportSize","width","height","contentPosition","x","y","slice","onRefreshViewport","bind","onSizeChanged","onScroll","onMouseMove","onClick","onCheckboxChange","onKeyDown","onFrameClick","onFrameMouseMove","getOptions","getGraphics","getLayout","setLayout","getEventArgs","onItemRender","onHighlightRender","onCursorRender","controlPanelRef","createRef","frameMousePanelRef","framePlaceholderRef","titlesMousePanelRef","titlesPlaceholderRef","scrollPanelRef","mousePanelRef","placeholderRef","calloutPlaceholderRef","layoutOptions","templatesHash","graphics","templates","tasks","require","observer","ResizeObserver","observe","current","fixPixelAlignment","clearTimeout","timer","disconnect","centerOnCursorTask","getTask","placeholderOffset","getPlaceholderOffset","scrollLeft","scrollTop","pixelAlignmentFix","style","marginLeft","marginTop","setState","setTimeout","Math","floor","event","pageX","left","pageY","top","projectItemsToFrameTask","highlightItemOptionTask","hasHighlightEnabled","itemId","getTreeItemForMousePosition","getGravityRadius","setHighlightItem","cursorItemOptionTask","newCursorItemId","hasCursorEnabled","setCursorItem","focus","createTransformTask","oldTreeItemId","newTreeItemId","name","result","combinedContextsTask","alignDiagramTask","oldItemConfig","getConfig","newItemConfig","itemPosition","offset","panelOffset","id","oldContext","context","parent","parentItem","getItemPosition","position","actualPosition","translate","newHighlightItemId","eventArgs","cancel","onHighlightChanging","onHighlightChanged","onCursorChanging","onCursorChanged","target","getAttribute","onSelectionChanging","onSelectionChanged","newSelectedItems","itemid","checked","filter","highlightItemTask","cursorItemTask","transform","getTransform","navigationItem","newNavigationItem","direction","accepted","getHighlightTreeItem","getCursorTreeItem","which","preventDefault","Bottom","Top","Left","Right","getOrientation","getNextItem","data","templateName","template","effectiveTemplates","map","itemTemplate","highlightTemplate","cursorTemplate","reduce","agg","forceCenterOnCursor","scrollPanelSize","autoSize","controlSize","scale","frameMousePanelRect","framePlaceholderSize","titlesMousePanelRect","titlesPlaceholderSize","scrollPanelRect","mousePanelSize","placeholderSize","process","placeholders","placeholder","calloutplaceholder","frameplaceholder","titlesplaceholder","placeholderRectCSS","rect","getCSS","scaletext","overflow","padding","marginBottom","marginRight","layerKey","elements","WebkitOverflowScrolling","border","nextProps","nextConfig","defaultProps"],"mappings":"0oCAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CAEA,OAASC,sBAAT,CAAiCC,YAAjC,CAA+CC,gBAA/C,CACEC,eADF,CAEEC,IAFF,CAEQC,IAFR,CAEcC,KAFd,KAGO,iBAHP,CAIA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,OACEC,uBADF,CAEEC,eAFF,CAGEC,gBAHF,CAIEC,cAJF,CAKEC,oBALF,CAMEC,kBANF,CAOEC,iBAPF,CAQEC,YARF,CASEC,YATF,CAUEC,uBAVF,CAWEC,kBAXF,CAYEC,uBAZF,KAaO,aAbP,C,gJAeMC,CAAAA,W,0GAqBJ,qBAAYC,KAAZ,CAAmBC,kBAAnB,CAAuCC,SAAvC,CAAkD,6CAChD,uBAAMF,KAAN,EAEA,MAAKC,kBAAL,CAA0BA,kBAA1B,CACA,MAAKC,SAAL,CAAiBA,SAAjB,CAJgD,GAMxCC,CAAAA,MANwC,CAMbH,KANa,CAMxCG,MANwC,CAMhCC,cANgC,CAMbJ,KANa,CAMhCI,cANgC,IAOxCC,CAAAA,aAPwC,CAOKF,MAPL,CAOxCE,aAPwC,CAOzBC,UAPyB,CAOKH,MAPL,CAOzBG,UAPyB,CAObC,aAPa,CAOKJ,MAPL,CAObI,aAPa,CAShD,MAAKC,KAAL,CAAa,CACXL,MAAM,CAANA,MADW,CAEXM,YAAY,CAAE,CACZC,KAAK,CAAE,CADK,CAEZC,MAAM,CAAE,CAFI,CAFH,CAMXC,eAAe,CAAE,CACfC,CAAC,CAAE,CADY,CAEfC,CAAC,CAAE,CAFY,CANN,CAUXV,cAAc,CAAdA,cAVW,CAWXC,aAAa,CAAbA,aAXW,CAYXC,UAAU,CAAVA,UAZW,CAaXC,aAAa,CAAE,CAACA,aAAa,EAAI,EAAlB,EAAsBQ,KAAtB,EAbJ,CAAb,CATgD,GAyBxCN,CAAAA,YAzBwC,CAyBvB,MAAKD,KAzBkB,CAyBxCC,YAzBwC,CA2BhD,MAAKO,iBAAL,CAAyB,MAAKA,iBAAL,CAAuBC,IAAvB,+BAAzB,CACA,MAAKC,aAAL,CAAqB,MAAKA,aAAL,CAAmBD,IAAnB,+BAArB,CACA,MAAKE,QAAL,CAAgB,MAAKA,QAAL,CAAcF,IAAd,+BAAhB,CACA,MAAKG,WAAL,CAAmB,MAAKA,WAAL,CAAiBH,IAAjB,+BAAnB,CACA,MAAKI,OAAL,CAAe,MAAKA,OAAL,CAAaJ,IAAb,+BAAf,CACA,MAAKK,gBAAL,CAAwB,MAAKA,gBAAL,CAAsBL,IAAtB,+BAAxB,CACA,MAAKM,SAAL,CAAiB,MAAKA,SAAL,CAAeN,IAAf,+BAAjB,CAEA,MAAKO,YAAL,CAAoB,MAAKA,YAAL,CAAkBP,IAAlB,+BAApB,CACA,MAAKQ,gBAAL,CAAwB,MAAKA,gBAAL,CAAsBR,IAAtB,+BAAxB,CAEA,MAAKS,UAAL,CAAkB,MAAKA,UAAL,CAAgBT,IAAhB,+BAAlB,CACA,MAAKU,WAAL,CAAmB,MAAKA,WAAL,CAAiBV,IAAjB,+BAAnB,CACA,MAAKW,SAAL,CAAiB,MAAKA,SAAL,CAAeX,IAAf,+BAAjB,CACA,MAAKY,SAAL,CAAiB,MAAKA,SAAL,CAAeZ,IAAf,+BAAjB,CACA,MAAKa,YAAL,CAAoB,MAAKA,YAAL,CAAkBb,IAAlB,+BAApB,CACA,MAAKb,cAAL,CAAsB,MAAKA,cAAL,CAAoBa,IAApB,+BAAtB,CAEA,MAAKc,YAAL,CAAoB,MAAKA,YAAL,CAAkBd,IAAlB,+BAApB,CACA,MAAKe,iBAAL,CAAyB,MAAKA,iBAAL,CAAuBf,IAAvB,+BAAzB,CACA,MAAKgB,cAAL,CAAsB,MAAKA,cAAL,CAAoBhB,IAApB,+BAAtB,CAGA,MAAKiB,eAAL,cAAuBzD,KAAK,CAAC0D,SAAN,EAAvB,CACA,MAAKC,kBAAL,cAA0B3D,KAAK,CAAC0D,SAAN,EAA1B,CACA,MAAKE,mBAAL,cAA2B5D,KAAK,CAAC0D,SAAN,EAA3B,CACA,MAAKG,mBAAL,cAA2B7D,KAAK,CAAC0D,SAAN,EAA3B,CACA,MAAKI,oBAAL,cAA4B9D,KAAK,CAAC0D,SAAN,EAA5B,CACA,MAAKK,cAAL,cAAsB/D,KAAK,CAAC0D,SAAN,EAAtB,CACA,MAAKM,aAAL,cAAqBhE,KAAK,CAAC0D,SAAN,EAArB,CACA,MAAKO,cAAL,cAAsBjE,KAAK,CAAC0D,SAAN,EAAtB,CACA,MAAKQ,qBAAL,cAA6BlE,KAAK,CAAC0D,SAAN,EAA7B,CAEA,MAAKS,aAAL,CAAqB,EAArB,CACA,MAAKC,aAAL,CAAqB,EAArB,CACA,MAAKC,QAAL,CAAgB,GAAI5D,CAAAA,QAAJ,CAAauB,YAAb,CAAhB,CACA,MAAKsC,SAAL,CAAiB,CACf5D,uBAAuB,CAAvBA,uBADe,CAEfC,eAAe,CAAfA,eAFe,CAGfC,gBAAgB,CAAhBA,gBAHe,CAIfC,cAAc,CAAdA,cAJe,CAKfC,oBAAoB,CAApBA,oBALe,CAMfC,kBAAkB,CAAlBA,kBANe,CAOfC,iBAAiB,CAAjBA,iBAPe,CAQfC,YAAY,CAAZA,YARe,CASfC,YAAY,CAAZA,YATe,CAUfC,uBAAuB,CAAvBA,uBAVe,CAWfC,kBAAkB,CAAlBA,kBAXe,CAYfC,uBAAuB,CAAvBA,uBAZe,CAAjB,CAcA,MAAKkD,KAAL,CAAa/C,kBAAkB,CAAC,MAAKyB,UAAN,CAAkB,MAAKC,WAAvB,CAAoC,MAAKC,SAAzC,CAAoD,MAAKC,SAAzD,CAAoE,MAAKkB,SAAzE,CAA/B,CA7EgD,aA8EjD,C,yDAkBD,4BAAoB,CAClB;AACA;AACA;AACAE,OAAO,CAAC,qDAAD,CAAP,CACA,KAAKC,QAAL,CAAgB,GAAIC,CAAAA,cAAJ,CAAmB,KAAKjC,aAAxB,CAAhB,CACA,KAAKgC,QAAL,CAAcE,OAAd,CAAsB,KAAKlB,eAAL,CAAqBmB,OAA3C,EAEA,KAAKjD,cAAL,GACA,KAAKkD,iBAAL,GACD,C,oCAED,+BAAuB,CACrB;AACAC,YAAY,CAAC,KAAKC,KAAN,CAAZ,CACA,KAAKA,KAAL,CAAa,IAAb,CACA;AACA,KAAKN,QAAL,CAAcO,UAAd,GACD,C,kCAED,6BAAqB,CACnB,KAAKrD,cAAL,GACD,C,8BAED,yBAAiB,IACPA,CAAAA,cADO,CACY,KAAKI,KADjB,CACPJ,cADO,CAEf,GAAIA,cAAJ,CAAoB,CAClB,sBACA,GAAMsD,CAAAA,kBAAkB,CAAG,KAAKV,KAAL,CAAWW,OAAX,CAAmB,oBAAnB,CAA3B,CACA,GAAMC,CAAAA,iBAAiB,CAAGF,kBAAkB,CAACG,oBAAnB,EAA1B,CAHkB,GAIPC,CAAAA,UAJO,CAIsBF,iBAJtB,CAIV/C,CAJU,CAIQkD,SAJR,CAIsBH,iBAJtB,CAIK9C,CAJL,CAKlB,KAAK0B,cAAL,CAAoBa,OAApB,CAA4BS,UAA5B,CAAyCA,UAAzC,CACA,KAAKtB,cAAL,CAAoBa,OAApB,CAA4BU,SAA5B,CAAwCA,SAAxC,CACD,CACF,C,iCAED,4BAAoB,IACVV,CAAAA,OADU,CACE,KAAKnB,eADP,CACVmB,OADU,CAElB,GAAIW,CAAAA,iBAAiB,CAAGrF,sBAAsB,CAAC0E,OAAD,CAA9C,CACAA,OAAO,CAACY,KAAR,CAAcC,UAAd,CAA2BF,iBAAiB,CAACtD,KAAlB,CAA0B,IAArD,CACA2C,OAAO,CAACY,KAAR,CAAcE,SAAd,CAA0BH,iBAAiB,CAACrD,MAAlB,CAA2B,IAArD,CACD,C,6BAED,wBAAgB,mBACY/B,YAAY,CAAC,KAAKsD,eAAL,CAAqBmB,OAAtB,CADxB,CACN3C,KADM,eACNA,KADM,CACCC,MADD,eACCA,MADD,CAEd,KAAKyD,QAAL,CAAc,CACZ3D,YAAY,CAAE,CACZC,KAAK,CAALA,KADY,CAEZC,MAAM,CAANA,MAFY,CADF,CAKZP,cAAc,CAAE,IALJ,CAAd,EAOD,C,wBAED,mBAAW,CACT,GAAI,KAAKoD,KAAL,EAAc,IAAlB,CAAwB,CACtB,KAAKA,KAAL,CAAaa,UAAU,CAAC,KAAKrD,iBAAN,CAAyB,GAAzB,CAAvB,CACD,CACF,C,iCAED,4BAAoB,CAClBuC,YAAY,CAAC,KAAKC,KAAN,CAAZ,CACA,KAAKA,KAAL,CAAa,IAAb,CAFkB,0BAIgB,KAAKhB,cAAL,CAAoBa,OAJpC,CAIVU,SAJU,uBAIVA,SAJU,CAICD,UAJD,uBAICA,UAJD,CAKlB,KAAKM,QAAL,CAAc,CACZxD,eAAe,CAAE,CAAEC,CAAC,CAAEyD,IAAI,CAACC,KAAL,CAAWT,UAAX,CAAL,CAA6BhD,CAAC,CAAEwD,IAAI,CAACC,KAAL,CAAWR,SAAX,CAAhC,CADL,CAEZ3D,cAAc,CAAE,KAFJ,CAAd,EAID,C,gCAED,0BAAiBoE,KAAjB,CAAwB,CAAC,GAAMZ,CAAAA,iBAAiB,CAAG/E,gBAAgB,CAAC,KAAKuD,kBAAL,CAAwBiB,OAAzB,CAA1C,CACrBxC,CAAC,CAAG2D,KAAK,CAACC,KAAN,CAAcb,iBAAiB,CAACc,IADf,CAErB5D,CAAC,CAAG0D,KAAK,CAACG,KAAN,CAAcf,iBAAiB,CAACgB,GAFf,CAGrBC,uBAAuB,CAAG,KAAK7B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAHL,CAIrBmB,uBAAuB,CAAG,KAAK9B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAJL,CAMvB,GAAImB,uBAAuB,CAACC,mBAAxB,EAAJ,CAAmD,CACjD,GAAMC,CAAAA,MAAM,CAAGH,uBAAuB,CAACI,2BAAxB,CAAoDpE,CAApD,CAAuDC,CAAvD,CAA0DgE,uBAAuB,CAACI,gBAAxB,EAA1D,CAAf,CACA,KAAKC,gBAAL,CAAsBX,KAAtB,CAA6BQ,MAA7B,EACD,CACF,C,4BAED,sBAAaR,KAAb,CAAoB,CAClB,GAAMZ,CAAAA,iBAAiB,CAAG/E,gBAAgB,CAAC,KAAKuD,kBAAL,CAAwBiB,OAAzB,CAA1C,CACExC,CAAC,CAAG2D,KAAK,CAACC,KAAN,CAAcb,iBAAiB,CAACc,IADtC,CAEE5D,CAAC,CAAG0D,KAAK,CAACG,KAAN,CAAcf,iBAAiB,CAACgB,GAFtC,CAGEC,uBAAuB,CAAG,KAAK7B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAH5B,CAIEyB,oBAAoB,CAAG,KAAKpC,KAAL,CAAWW,OAAX,CAAmB,sBAAnB,CAJzB,CAKEmB,uBAAuB,CAAG,KAAK9B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAL5B,CAME0B,eAAe,CAAGR,uBAAuB,CAACI,2BAAxB,CAAoDpE,CAApD,CAAuDC,CAAvD,CAA0DgE,uBAAuB,CAACI,gBAAxB,EAA1D,CANpB,CAOA,GAAIG,eAAe,GAAK,IAAxB,CAA8B,CAC5B,GAAID,oBAAoB,CAACE,gBAArB,EAAJ,CAA6C,CAC3C,KAAKC,aAAL,CAAmBf,KAAnB,CAA0Ba,eAA1B,EACA,KAAKnD,eAAL,CAAqBmB,OAArB,CAA6BmC,KAA7B,GACD,CACF,CACF,C,2BAED,qBAAYhB,KAAZ,CAAmB,CACjB,GAAMZ,CAAAA,iBAAiB,CAAG/E,gBAAgB,CAAC,KAAK4D,aAAL,CAAmBY,OAApB,CAA1C,CACExC,CAAC,CAAG2D,KAAK,CAACC,KAAN,CAAcb,iBAAiB,CAACc,IADtC,CAEE5D,CAAC,CAAG0D,KAAK,CAACG,KAAN,CAAcf,iBAAiB,CAACgB,GAFtC,CAGEa,mBAAmB,CAAG,KAAKzC,KAAL,CAAWW,OAAX,CAAmB,qBAAnB,CAHxB,CAIEmB,uBAAuB,CAAG,KAAK9B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAJ5B,CAMA,GAAImB,uBAAuB,CAACC,mBAAxB,EAAJ,CAAmD,CACjD,GAAMC,CAAAA,MAAM,CAAGS,mBAAmB,CAACR,2BAApB,CAAgDpE,CAAhD,CAAmDC,CAAnD,CAAsDgE,uBAAuB,CAACI,gBAAxB,EAAtD,CAAf,CACA,KAAKC,gBAAL,CAAsBX,KAAtB,CAA6BQ,MAA7B,EACD,CACF,C,4BAED,sBAAaU,aAAb,CAA4BC,aAA5B,CAA2CC,IAA3C,CAAiD,CAC/C,GAAIC,CAAAA,MAAM,CAAG,GAAI,MAAK3F,SAAT,EAAb,CACE4F,oBAAoB,CAAG,KAAK9C,KAAL,CAAWW,OAAX,CAAmB,sBAAnB,CADzB,CAEEoC,gBAAgB,CAAG,KAAK/C,KAAL,CAAWW,OAAX,CAAmB,kBAAnB,CAFrB,CAGEqC,aAAa,CAAGF,oBAAoB,CAACG,SAArB,CAA+BP,aAA/B,CAHlB,CAIEQ,aAAa,CAAGJ,oBAAoB,CAACG,SAArB,CAA+BN,aAA/B,CAJlB,CAKEQ,YALF,CAMEC,MANF,CAOEC,WAPF,CASA,GAAIL,aAAa,EAAIA,aAAa,CAACM,EAAd,EAAoB,IAAzC,CAA+C,CAC7CT,MAAM,CAACU,UAAP,CAAoBP,aAApB,CACD,CAED,GAAIE,aAAa,EAAIA,aAAa,CAACI,EAAd,EAAoB,IAAzC,CAA+C,CAC7CT,MAAM,CAACW,OAAP,CAAiBN,aAAjB,CAEA,GAAIA,aAAa,CAACO,MAAd,GAAyB,IAA7B,CAAmC,CACjCZ,MAAM,CAACa,UAAP,CAAoBZ,oBAAoB,CAACG,SAArB,CAA+BC,aAAa,CAACO,MAA7C,CAApB,CACD,CAEDJ,WAAW,CAAGxH,gBAAgB,CAAC,KAAK4D,aAAL,CAAmBY,OAApB,CAA9B,CACA+C,MAAM,CAAGvH,gBAAgB,CAAC,KAAK2D,cAAL,CAAoBa,OAArB,CAAzB,CACA8C,YAAY,CAAGJ,gBAAgB,CAACY,eAAjB,CAAiChB,aAAjC,CAAf,CACAE,MAAM,CAACe,QAAP,CAAkB,GAAI7H,CAAAA,IAAJ,CAASoH,YAAY,CAACU,cAAtB,EACfC,SADe,CACLT,WAAW,CAAC3B,IADP,CACa2B,WAAW,CAACzB,GADzB,EAEfkC,SAFe,CAEL,CAACV,MAAM,CAAC1B,IAFH,CAES,CAAC0B,MAAM,CAACxB,GAFjB,CAAlB,CAGD,CAED,GAAIgB,IAAI,EAAI,IAAZ,CAAkB,CAChBC,MAAM,CAACD,IAAP,CAAcA,IAAd,CACD,CAED,MAAOC,CAAAA,MAAP,CACD,C,gCAED,0BAAiBrB,KAAjB,CAAwBuC,kBAAxB,CAA4C,CAC1C,GAAIC,CAAAA,SAAJ,CAAeC,MAAM,CAAG,KAAxB,CAD0C,gBAEU,KAAKjH,KAFf,CAElCkH,mBAFkC,aAElCA,mBAFkC,CAEbC,kBAFa,aAEbA,kBAFa,IAGlC9G,CAAAA,aAHkC,CAGhB,KAAKG,KAHW,CAGlCH,aAHkC,CAI1C,GAAI0G,kBAAkB,GAAK1G,aAA3B,CAA0C,CACxC2G,SAAS,CAAG,KAAKlF,YAAL,CAAkBzB,aAAlB,CAAiC0G,kBAAjC,CAAZ,CAEA,GAAIG,mBAAmB,EAAI,IAA3B,CAAiC,CAC/B,GAAI,CAACA,mBAAmB,CAAC1C,KAAD,CAAQwC,SAAR,CAAxB,CAA4C,CAC1CC,MAAM,CAAG,IAAT,CACA,KAAK7C,QAAL,CAAc,CACZ/D,aAAa,CAAE0G,kBADH,CAAd,EAGD,CACF,CAPD,IAOO,CACL,KAAK3C,QAAL,CAAc,CACZ/D,aAAa,CAAE0G,kBADH,CAAd,EAGD,EACD,GAAI,CAACE,MAAL,CAAa,CACX,GAAIE,kBAAkB,EAAI,IAA1B,CAAgC,CAC9BA,kBAAkB,CAAC3C,KAAD,CAAQwC,SAAR,CAAlB,CACD,CACF,CACF,CACF,C,6BAED,uBAAcxC,KAAd,CAAqBa,eAArB,CAAsC,CACpC,GAAI2B,CAAAA,SAAJ,CAAeC,MAAM,CAAG,KAAxB,CADoC,iBAEU,KAAKjH,KAFf,CAE5BoH,gBAF4B,cAE5BA,gBAF4B,CAEVC,eAFU,cAEVA,eAFU,IAG5B/G,CAAAA,UAH4B,CAGb,KAAKE,KAHQ,CAG5BF,UAH4B,CAIpC,GAAI+E,eAAe,GAAK/E,UAAxB,CAAoC,CAClC0G,SAAS,CAAG,KAAKlF,YAAL,CAAkBxB,UAAlB,CAA8B+E,eAA9B,CAAZ,CAEA,GAAI+B,gBAAgB,EAAI,IAAxB,CAA8B,CAC5B,GAAI,CAACA,gBAAgB,CAAC5C,KAAD,CAAQwC,SAAR,CAArB,CAAyC,CACvCC,MAAM,CAAG,IAAT,CACA,KAAK7C,QAAL,CAAc,CACZ9D,UAAU,CAAE+E,eADA,CAEZjF,cAAc,CAAE,IAFJ,CAAd,EAID,CACF,CARD,IAQO,CACL,KAAKgE,QAAL,CAAc,CACZ9D,UAAU,CAAE+E,eADA,CAEZjF,cAAc,CAAE,IAFJ,CAAd,EAID,CAGD,GAAI,CAAC6G,MAAL,CAAa,CACX,GAAII,eAAe,EAAI,IAAvB,CAA6B,CAC3BA,eAAe,CAAC7C,KAAD,CAAQwC,SAAR,CAAf,CACD,CACF,CACF,CACF,C,uBAED,iBAAQxC,KAAR,CAAe,CACb,GAAIZ,CAAAA,iBAAiB,CAAG/E,gBAAgB,CAAC,KAAK4D,aAAL,CAAmBY,OAApB,CAAxC,CACExC,CAAC,CAAG2D,KAAK,CAACC,KAAN,CAAcb,iBAAiB,CAACc,IADtC,CAEE5D,CAAC,CAAG0D,KAAK,CAACG,KAAN,CAAcf,iBAAiB,CAACgB,GAFtC,CAGEa,mBAAmB,CAAG,KAAKzC,KAAL,CAAWW,OAAX,CAAmB,qBAAnB,CAHxB,CAIEyB,oBAAoB,CAAG,KAAKpC,KAAL,CAAWW,OAAX,CAAmB,sBAAnB,CAJzB,CAKEmB,uBAAuB,CAAG,KAAK9B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAL5B,CAME0B,eAAe,CAAGI,mBAAmB,CAACR,2BAApB,CAAgDpE,CAAhD,CAAmDC,CAAnD,CAAsDgE,uBAAuB,CAACI,gBAAxB,EAAtD,CANpB,CAOEoC,MAPF,CAQAA,MAAM,CAAG9C,KAAK,CAAC8C,MAAf,CACA,GAAIjC,eAAe,GAAK,IAAxB,CAA8B,CAC5B,GAAIiC,MAAM,CAACC,YAAP,CAAoB,MAApB,IAAgC,UAAhC,EAA8CD,MAAM,CAACC,YAAP,CAAoB,MAApB,IAAgC,eAAlF,CAAmG,CAAE;AAEpG,CAFD,IAGK,CACH,GAAInC,oBAAoB,CAACE,gBAArB,EAAJ,CAA6C,CAC3C,KAAKC,aAAL,CAAmBf,KAAnB,CAA0Ba,eAA1B,EACA,KAAKnD,eAAL,CAAqBmB,OAArB,CAA6BmC,KAA7B,GACD,CACF,CACF,CACF,C,gCAED,0BAAiBhB,KAAjB,CAAwB,kBAC8B,KAAKxE,KADnC,CACdwH,mBADc,cACdA,mBADc,CACOC,kBADP,cACOA,kBADP,IAEhBlH,CAAAA,aAFgB,CAEE,KAAKC,KAFP,CAEhBD,aAFgB,CAGtB,GAAImH,CAAAA,gBAAgB,CAAG,EAAvB,CAHsB,GAIdJ,CAAAA,MAJc,CAIH9C,KAJG,CAId8C,MAJc,CAKtB,GAAIK,CAAAA,MAAM,CAAGL,MAAM,CAACC,YAAP,CAAoB,SAApB,CAAb,CACA,GAAMK,CAAAA,OAAO,CAAGpD,KAAK,CAAC8C,MAAN,CAAaM,OAA7B,CACA,GAAIX,CAAAA,MAAM,CAAG,KAAb,CACA,GAAIU,MAAM,EAAI,IAAd,CAAoB,CAClB,GAAIC,OAAJ,CAAa,CACXF,gBAAgB,8BAAOnH,aAAP,GAAsBoH,MAAtB,EAAhB,CACD,CAFD,IAGK,CACH;AACAD,gBAAgB,CAAGnH,aAAa,CAACsH,MAAd,CAAqB,SAAAvB,EAAE,QAAIA,CAAAA,EAAE,EAAIqB,MAAV,EAAvB,CAAnB,CAA6D;AAC9D,CACD,GAAIH,mBAAmB,EAAI,IAA3B,CAAiC,CAC/BP,MAAM,CAAGO,mBAAmB,CAAChD,KAAD,CAAQjE,aAAR,CAAuBmH,gBAAvB,CAA5B,CACD,CACD,GAAI,CAACT,MAAL,CAAa,CACX,KAAK7C,QAAL,CAAc,CACZ7D,aAAa,CAAEmH,gBADH,CAAd,EAIA,GAAID,kBAAkB,EAAI,IAA1B,CAAgC,CAC9BA,kBAAkB,CAACjD,KAAD,CAAQjE,aAAR,CAAuBmH,gBAAvB,CAAlB,CACD,CACF,CACF,CACF,C,yBAED,mBAAUlD,KAAV,CAAiB,CACf,GAAIsD,CAAAA,iBAAiB,CAAG,KAAK9E,KAAL,CAAWW,OAAX,CAAmB,mBAAnB,CAAxB,CACEmB,uBAAuB,CAAG,KAAK9B,KAAL,CAAWW,OAAX,CAAmB,yBAAnB,CAD5B,CAEEoE,cAAc,CAAG,KAAK/E,KAAL,CAAWW,OAAX,CAAmB,gBAAnB,CAFnB,CAGEyB,oBAAoB,CAAG,KAAKpC,KAAL,CAAWW,OAAX,CAAmB,sBAAnB,CAHzB,CAIEoC,gBAAgB,CAAG,KAAK/C,KAAL,CAAWW,OAAX,CAAmB,kBAAnB,CAJrB,CAKE8B,mBAAmB,CAAG,KAAKzC,KAAL,CAAWW,OAAX,CAAmB,qBAAnB,CALxB,CAMEqE,SAAS,CAAGvC,mBAAmB,CAACwC,YAApB,EANd,CAOEC,cAAc,CAAG,IAPnB,CAQEC,iBARF,CASEC,SAAS,CAAG,IATd,CAUEC,QAVF,CAYA,GAAIvD,uBAAuB,CAACC,mBAAxB,IAAiDK,oBAAoB,CAACE,gBAArB,EAArD,CAA8F,CAC5F4C,cAAc,CAAGJ,iBAAiB,CAACQ,oBAAlB,EAAjB,CACA,GAAIJ,cAAc,GAAK,IAAvB,CAA6B,CAC3BA,cAAc,CAAGH,cAAc,CAACQ,iBAAf,EAAjB,CACD,CACF,CALD,IAKO,IAAIzD,uBAAuB,CAACC,mBAAxB,EAAJ,CAAmD,CACxDmD,cAAc,CAAGJ,iBAAiB,CAACQ,oBAAlB,EAAjB,CACD,CAFM,IAEA,IAAIlD,oBAAoB,CAACE,gBAArB,EAAJ,CAA6C,CAClD4C,cAAc,CAAGH,cAAc,CAACQ,iBAAf,EAAjB,CACD,CAGD,GAAIL,cAAc,EAAI,IAAtB,CAA4B,CAC1B,OAAQ1D,KAAK,CAACgE,KAAd,EACE,IAAK,GAAL,CAAS,SACP,GAAIpD,oBAAoB,CAACE,gBAArB,EAAJ,CAA6C,CAC3C,KAAKC,aAAL,CAAmBf,KAAnB,CAA0B0D,cAA1B,EACA1D,KAAK,CAACiE,cAAN,GACA,KAAKvG,eAAL,CAAqBmB,OAArB,CAA6BmC,KAA7B,GACD,CACD,MACF,IAAK,GAAL,CAAS,QACP4C,SAAS,CAAGtJ,eAAe,CAAC4J,MAA5B,CACA,MACF,IAAK,GAAL,CAAS,MACPN,SAAS,CAAGtJ,eAAe,CAAC6J,GAA5B,CACA,MACF,IAAK,GAAL,CAAS,QACPP,SAAS,CAAGtJ,eAAe,CAAC8J,IAA5B,CACA,MACF,IAAK,GAAL,CAAS,SACPR,SAAS,CAAGtJ,eAAe,CAAC+J,KAA5B,CACA,MACF,QACE,MArBJ,CAwBA,GAAIT,SAAS,EAAI,IAAjB,CAAuB,CAErBC,QAAQ,CAAG,KAAX,CAEA,MAAO,CAACA,QAAR,CAAkB,CAChBA,QAAQ,CAAG,IAAX,CAEAD,SAAS,CAAGJ,SAAS,CAACc,cAAV,CAAyBV,SAAzB,CAAZ,CACAD,iBAAiB,CAAGpC,gBAAgB,CAACgD,WAAjB,CAA6Bb,cAA7B,CAA6CE,SAA7C,CAApB,CAEA,GAAID,iBAAiB,EAAI,IAAzB,CAA+B,CAC7B3D,KAAK,CAACiE,cAAN,GACA,GAAI3D,uBAAuB,CAACC,mBAAxB,EAAJ,CAAmD,CACjD,KAAKI,gBAAL,CAAsBX,KAAtB,CAA6B2D,iBAA7B,EACD,CAFD,IAEO,IAAI/C,oBAAoB,CAACE,gBAArB,EAAJ,CAA6C,CAClD,KAAKC,aAAL,CAAmBf,KAAnB,CAA0B2D,iBAA1B,EACD,CAEF,CACF,CACD,KAAKjG,eAAL,CAAqBmB,OAArB,CAA6BmC,KAA7B,GACD,CACF,CACF,C,4BAED,sBAAawD,IAAb,CAAmB,IACTC,CAAAA,YADS,CACQD,IADR,CACTC,YADS,CAEjB,GAAMC,CAAAA,QAAQ,CAAG,KAAKrG,aAAL,CAAmBoG,YAAnB,CAAjB,CACA,MAAOC,CAAAA,QAAQ,CAACnH,YAAT,CAAsBiH,IAAtB,CAAP,CACD,C,iCAED,2BAAkBA,IAAlB,CAAwB,IACdC,CAAAA,YADc,CACGD,IADH,CACdC,YADc,CAEtB,GAAMC,CAAAA,QAAQ,CAAG,KAAKrG,aAAL,CAAmBoG,YAAnB,CAAjB,CACA,MAAOC,CAAAA,QAAQ,CAAClH,iBAAT,CAA2BgH,IAA3B,CAAP,CACD,C,8BAED,wBAAeA,IAAf,CAAqB,IACXC,CAAAA,YADW,CACMD,IADN,CACXC,YADW,CAEnB,GAAMC,CAAAA,QAAQ,CAAG,KAAKrG,aAAL,CAAmBoG,YAAnB,CAAjB,CACA,MAAOC,CAAAA,QAAQ,CAACjH,cAAT,CAAwB+G,IAAxB,CAAP,CACD,C,0BAED,qBAAa,IACH7I,CAAAA,MADG,CACQ,KAAKH,KADb,CACHG,MADG,CAEX,GAAM4C,CAAAA,SAAS,CAAG5C,MAAM,CAAC4C,SAAP,EAAoB,EAAtC,CAEA,GAAMoG,CAAAA,kBAAkB,CAAGpG,SAAS,CAACqG,GAAV,CAAc,SAAAF,QAAQ,CAAI,IAC3CnH,CAAAA,YAD2C,CACSmH,QADT,CAC3CnH,YAD2C,CAC7BC,iBAD6B,CACSkH,QADT,CAC7BlH,iBAD6B,CACVC,cADU,CACSiH,QADT,CACVjH,cADU,CAEnD,sCACKiH,QADL,MAEEG,YAAY,CAAG,CAACtH,YAAD,CAAgB,IAAhB,CAAuB,iDAFxC,CAGEuH,iBAAiB,CAAG,CAACtH,iBAAD,CAAqB,IAArB,CAA4B,iDAHlD,CAIEuH,cAAc,CAAG,CAACtH,cAAD,CAAkB,IAAlB,CAAyB,iDAJ5C,GAMD,CAR0B,CAA3B,CAUA,KAAKY,aAAL,CAAqBE,SAAS,CAACyG,MAAV,CAAiB,SAACC,GAAD,CAAMP,QAAN,CAAmB,IAC/CtD,CAAAA,IAD+C,CACtCsD,QADsC,CAC/CtD,IAD+C,CAEvD6D,GAAG,CAAC7D,IAAD,CAAH,CAAYsD,QAAZ,CACA,MAAOO,CAAAA,GAAP,CACD,CAJoB,CAIlB,EAJkB,CAArB,CAdW,gBAoB0C,KAAKjJ,KApB/C,CAoBHH,aApBG,aAoBHA,aApBG,CAoBYC,UApBZ,aAoBYA,UApBZ,CAoBwBC,aApBxB,aAoBwBA,aApBxB,CAqBX,sCACKJ,MADL,MAEE4C,SAAS,CAAEoG,kBAFb,CAGE9I,aAAa,CAAbA,aAHF,CAIEC,UAAU,CAAVA,UAJF,CAKEC,aAAa,CAAbA,aALF,CAMEwB,YAAY,CAAE,KAAKA,YANrB,CAOEE,cAAc,CAAE,KAAKA,cAPvB,CAQED,iBAAiB,CAAE,KAAKA,iBAR1B,GAUD,C,2BAED,sBAAc,CACZ,MAAO,MAAKc,QAAZ,CACD,C,yBAED,oBAAY,kBACgD,KAAKtC,KADrD,CACFJ,cADE,cACFA,cADE,CACcK,YADd,cACcA,YADd,CAC4BG,eAD5B,cAC4BA,eAD5B,CAEV,MAAO,CACL8I,mBAAmB,CAAEtJ,cADhB,CAELuJ,eAAe,CAAE,GAAI3K,CAAAA,IAAJ,CAASyB,YAAT,CAFZ,CAGLmD,iBAAiB,CAAE,GAAI3E,CAAAA,KAAJ,CAAU2B,eAAV,CAHd,CAAP,CAKD,C,yBAED,mBAAUgC,aAAV,CAAyB,IAEnBgH,CAAAA,QAFmB,CAYnBhH,aAZmB,CAEnBgH,QAFmB,CAGnBC,WAHmB,CAYnBjH,aAZmB,CAGnBiH,WAHmB,CAInBC,KAJmB,CAYnBlH,aAZmB,CAInBkH,KAJmB,CAKnBC,mBALmB,CAYnBnH,aAZmB,CAKnBmH,mBALmB,CAMnBC,oBANmB,CAYnBpH,aAZmB,CAMnBoH,oBANmB,CAOnBC,oBAPmB,CAYnBrH,aAZmB,CAOnBqH,oBAPmB,CAQnBC,qBARmB,CAYnBtH,aAZmB,CAQnBsH,qBARmB,CASnBC,eATmB,CAYnBvH,aAZmB,CASnBuH,eATmB,CAUnBC,cAVmB,CAYnBxH,aAZmB,CAUnBwH,cAVmB,CAWnBC,eAXmB,CAYnBzH,aAZmB,CAWnByH,eAXmB,CAcvB,KAAKzH,aAAL,CAAqB,CACnBgH,QAAQ,CAARA,QADmB,CAEnBC,WAAW,CAAE,GAAI7K,CAAAA,IAAJ,CAAS6K,WAAT,CAFM,CAGnBC,KAAK,CAALA,KAHmB,CAInBC,mBAAmB,CAAE,GAAIhL,CAAAA,IAAJ,CAASgL,mBAAT,CAJF,CAKnBC,oBAAoB,CAAE,GAAIhL,CAAAA,IAAJ,CAASgL,oBAAT,CALH,CAOnBC,oBAAoB,CAAE,GAAIlL,CAAAA,IAAJ,CAASkL,oBAAT,CAPH,CAQnBC,qBAAqB,CAAE,GAAIlL,CAAAA,IAAJ,CAASkL,qBAAT,CARJ,CAUnBC,eAAe,CAAE,GAAIpL,CAAAA,IAAJ,CAASoL,eAAT,CAVE,CAWnBC,cAAc,CAAE,GAAIpL,CAAAA,IAAJ,CAASoL,cAAT,CAXG,CAYnBC,eAAe,CAAE,GAAIrL,CAAAA,IAAJ,CAASqL,eAAT,CAZE,CAArB,CAcD,C,sBAED,iBAAS,CACP,GAAMvH,CAAAA,QAAQ,CAAG,KAAKA,QAAtB,CACA,KAAKE,KAAL,CAAWsH,OAAX,CAAmB,aAAnB,CAAkC,IAAlC,CAAwC,KAAxC,EAFO,0BAI0E,KAAKxH,QAAL,CAAcyH,YAJxF,CAICC,WAJD,uBAICA,WAJD,CAIcC,kBAJd,uBAIcA,kBAJd,CAIkCC,gBAJlC,uBAIkCA,gBAJlC,CAIoDC,iBAJpD,uBAIoDA,iBAJpD,CAKP,GAAMC,CAAAA,kBAAkB,CAAGJ,WAAW,CAACK,IAAZ,CAAiBC,MAAjB,EAA3B,CALO,wBAeH,KAAKlI,aAfF,CAQLgH,QARK,qBAQLA,QARK,CASLC,WATK,qBASLA,WATK,CAULC,KAVK,qBAULA,KAVK,CAWLC,mBAXK,qBAWLA,mBAXK,CAYLE,oBAZK,qBAYLA,oBAZK,CAaLE,eAbK,qBAaLA,eAbK,CAcLC,cAdK,qBAcLA,cAdK,CAiBP,8BACA,GAAIW,CAAAA,SAAS,CAAG,SAAWjB,KAAX,CAAmB,GAAnB,CAAyBA,KAAzB,CAAiC,GAAjD,CAEA,mBAAO,sCACL,aAAK,wBACH,GAAG,CAAE,KAAK5H,eADZ,CAEE,SAAS,CAAE,KAAKX,SAFlB,CAGE,KAAK,gBACHqF,QAAQ,CAAE,UADP,CAEHoE,QAAQ,CAAE,QAFP,CAGHpG,GAAG,CAAE,KAHF,CAIHF,IAAI,CAAE,KAJH,CAKHhE,KAAK,CAAE,MALJ,CAMHC,MAAM,CAAE,MANL,CAOHsK,OAAO,CAAE,KAPN,CAQHC,YAAY,CAAE,KARX,CASHC,WAAW,CAAE,KATV,EAUCvB,QAAQ,CAAGC,WAAW,CAACiB,MAAZ,EAAH,CAA0B,EAVnC,CAHP,CAeE,QAAQ,CAAC,GAfX,WAiBGJ,gBAAgB,eACf,YACE,GAAG,CAAE,KAAKtI,kBADZ,CAEE,WAAW,CAAE,KAAKX,gBAFpB,CAGE,OAAO,CAAE,KAAKD,YAHhB,CAIE,KAAK,gBACHoF,QAAQ,CAAE,UADP,CAEHoE,QAAQ,CAAE,QAFP,EAGCjB,mBAAmB,CAACe,MAApB,EAHD,CAJP,uBASE,YACE,GAAG,CAAE,KAAKzI,mBADZ,CAEE,KAAK,gCACCqI,gBAAgB,CAACG,IAAjB,CAAsBC,MAAtB,EADD,MAEHlE,QAAQ,CAAE,UAFP,CAGHoE,QAAQ,CAAE,QAHP,CAIH,kBAAmB,KAJhB,CAKH,YAAaD,SALV,CAMH,cAAeA,SANZ,CAMuB,UAC1B,kBAAmBA,SAPhB,CAO2B,uBAC9B,aAAcA,SARX,CAQsB,WACzB,eAAgBA,SAAU,aATvB,EAFP,UAaGjI,QAAQ,CAACsG,GAAT,CAAa,IAAb,CAAmB,kBAAnB,CAAuC,SAACgC,QAAD,CAAWC,QAAX,qBACtC,YAAoB,KAAK,CAAE,CACzBzE,QAAQ,CAAE,UADe,CAEzBoE,QAAQ,CAAE,SAFe,CAGzBtG,IAAI,CAAE,KAHmB,CAIzBE,GAAG,CAAE,KAJoB,CAA3B,UAMGyG,QANH,EAAUD,QAAV,CADsC,EAAvC,CAbH,EATF,EAlBJ,CAqDGT,iBAAiB,eAChB,YACE,GAAG,CAAE,KAAKrI,mBADZ,CAEE,WAAW,CAAE,KAAKb,gBAFpB,CAGE,OAAO,CAAE,KAAKD,YAHhB,CAIE,KAAK,gBACHoF,QAAQ,CAAE,UADP,CAEHoE,QAAQ,CAAE,QAFP,EAGCf,oBAAoB,CAACa,MAArB,EAHD,CAJP,uBASE,YACE,GAAG,CAAE,KAAKxI,mBADZ,CAEE,KAAK,gCACCqI,iBAAiB,CAACE,IAAlB,CAAuBC,MAAvB,EADD,MAEHlE,QAAQ,CAAE,UAFP,CAGHoE,QAAQ,CAAE,QAHP,CAIH,kBAAmB,KAJhB,CAKH,YAAaD,SALV,CAMH,cAAeA,SANZ,CAMuB,UAC1B,kBAAmBA,SAPhB,CAO2B,uBAC9B,aAAcA,SARX,CAQsB,WACzB,eAAgBA,SAAU,aATvB,EAFP,UAaGjI,QAAQ,CAACsG,GAAT,CAAa,IAAb,CAAmB,mBAAnB,CAAwC,SAACgC,QAAD,CAAWC,QAAX,qBACvC,YAAoB,KAAK,CAAE,CACzBzE,QAAQ,CAAE,UADe,CAEzBoE,QAAQ,CAAE,SAFe,CAGzBtG,IAAI,CAAE,KAHmB,CAIzBE,GAAG,CAAE,KAJoB,CAA3B,UAMGyG,QANH,EAAUD,QAAV,CADuC,EAAxC,CAbH,EATF,EAtDJ,cAyFE,YACE,GAAG,CAAE,KAAK5I,cADZ,CAEE,QAAQ,CAAE,KAAKrB,QAFjB,CAGE,KAAK,8BACHyF,QAAQ,CAAE,UADP,CAEHoE,QAAQ,CAAE,MAFP,CAGHM,uBAAuB,CAAE,OAHtB,EAICnB,eAAe,CAACW,MAAhB,EAJD,MAKHS,MAAM,CAAGpB,eAAe,CAACtJ,CAAhB,CAAoB,CAApB,CAAwB,oBAAxB,CAA+C,EALrD,EAHP,uBAWE,YACE,GAAG,CAAE,KAAK4B,aADZ,CAEE,WAAW,CAAE,KAAKrB,WAFpB,CAGE,OAAO,CAAE,KAAKC,OAHhB,CAIE,QAAQ,CAAE,KAAKC,gBAJjB,CAKE,KAAK,gBACHsF,QAAQ,CAAE,UADP,CAEHoE,QAAQ,CAAE,QAFP,EAGCZ,cAAc,CAACU,MAAf,EAHD,CALP,uBAUE,aACE,GAAG,CAAE,KAAKpI,cADZ,CAEE,KAAK,gCACAkI,kBADA,MAEHhE,QAAQ,CAAE,UAFP,CAGHoE,QAAQ,CAAE,QAHP,CAIH,kBAAmB,KAJhB,CAKH,YAAaD,SALV,CAMH,cAAeA,SANZ,CAMuB,UAC1B,kBAAmBA,SAPhB,CAO2B,uBAC9B,aAAcA,SARX,CAQsB,WACzB,eAAgBA,SAAU,aATvB,EAFP,WAaGjI,QAAQ,CAACsG,GAAT,CAAa,IAAb,CAAmB,aAAnB,CAAkC,SAACgC,QAAD,CAAWC,QAAX,qBACjC,YAAoB,KAAK,CAAE,CACzBzE,QAAQ,CAAE,UADe,CAEzBoE,QAAQ,CAAE,SAFe,CAGzBtG,IAAI,CAAE,KAHmB,CAIzBE,GAAG,CAAE,KAJoB,CAA3B,UAMGyG,QANH,EAAUD,QAAV,CADiC,EAAlC,CAbH,CAuBGX,kBAAkB,eACjB,YACE,KAAK,CAAE,CACL7D,QAAQ,CAAE,UADL,CAELoE,QAAQ,CAAE,SAFL,CAGLtG,IAAI,CAAE+F,kBAAkB,CAACI,IAAnB,CAAwBhK,CAAxB,CAA4B,IAH7B,CAIL+D,GAAG,CAAE6F,kBAAkB,CAACI,IAAnB,CAAwB/J,CAAxB,CAA4B,IAJ5B,CADT,UAOGgC,QAAQ,CAACsG,GAAT,CAAa,IAAb,CAAmB,oBAAnB,CAAyC,SAACgC,QAAD,CAAWC,QAAX,qBACxC,YAAoB,KAAK,CAAE,CACzBzE,QAAQ,CAAE,UADe,CAEzBoE,QAAQ,CAAE,SAFe,CAA3B,UAIGK,QAJH,EAAUD,QAAV,CADwC,EAAzC,CAPH,EAAS,SAAT,CAxBJ,GAVF,EAXF,EAzFF,GADK,EAAP,CA6JD,C,0CA9mBD,kCAAgCI,SAAhC,CAA2ChL,KAA3C,CAAkD,IAChCiL,CAAAA,UADgC,CACDD,SADC,CACxCrL,MADwC,CACpBC,cADoB,CACDoL,SADC,CACpBpL,cADoB,IAExCD,CAAAA,MAFwC,CAE7BK,KAF6B,CAExCL,MAFwC,CAGhD,GAAIA,MAAM,GAAKsL,UAAf,CAA2B,IACjBpL,CAAAA,aADiB,CAC4BoL,UAD5B,CACjBpL,aADiB,CACFC,UADE,CAC4BmL,UAD5B,CACFnL,UADE,CACUC,aADV,CAC4BkL,UAD5B,CACUlL,aADV,CAEzB,MAAO,CACLJ,MAAM,CAAEsL,UADH,CAELpL,aAAa,CAAbA,aAFK,CAGLC,UAAU,CAAVA,UAHK,CAILC,aAAa,CAAE,CAACA,aAAa,EAAI,EAAlB,EAAsBQ,KAAtB,EAJV,CAKLX,cAAc,CAAdA,cALK,CAAP,CAOD,CACD,MAAO,KAAP,CACD,C,yBAnHuB1B,S,EAApBqB,W,CAWG2L,Y,CAAe,CACpBtL,cAAc,CAAE,IADI,CAEpB8G,mBAAmB,CAAE,IAFD,CAGpBC,kBAAkB,CAAE,IAHA,CAIpBC,gBAAgB,CAAE,IAJE,CAKpBC,eAAe,CAAE,IALG,CAMpBG,mBAAmB,CAAE,IAND,CAOpBC,kBAAkB,CAAE,IAPA,C,CA2sBxB,cAAe1H,CAAAA,WAAf","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { getFixOfPixelAlignment, getInnerSize, getElementOffset,\n  OrientationType,\n  Rect, Size, Point\n} from 'basicprimitives';\nimport Graphics from './Graphics';\nimport {\n  AnnotationLabelTemplate,\n  ButtonsTemplate,\n  CheckBoxTemplate,\n  CursorTemplate,\n  DotHighlightTemplate,\n  GroupTitleTemplate,\n  HighlightTemplate,\n  ItemTemplate,\n  UserTemplate,\n  LabelAnnotationTemplate,\n  LevelTitleTemplate,\n  LevelBackgroundTemplate\n} from './Templates';\n\nclass BaseDiagram extends Component {\n  static propTypes = {\n    centerOnCursor: PropTypes.bool, // eslint-disable-line react/no-unused-prop-types\n    onHighlightChanging: PropTypes.func, // eslint-disable-line react/no-unused-prop-types\n    onHighlightChanged: PropTypes.func, // eslint-disable-line react/no-unused-prop-types\n    onCursorChanging: PropTypes.func, // eslint-disable-line react/no-unused-prop-types\n    onCursorChanged: PropTypes.func, // eslint-disable-line react/no-unused-prop-types\n    onSelectionChanging: PropTypes.func, // eslint-disable-line react/no-unused-prop-types\n    onSelectionChanged: PropTypes.func // eslint-disable-line react/no-unused-prop-types\n  };\n\n  static defaultProps = {\n    centerOnCursor: true,\n    onHighlightChanging: null,\n    onHighlightChanged: null,\n    onCursorChanging: null,\n    onCursorChanged: null,\n    onSelectionChanging: null,\n    onSelectionChanged: null\n  };\n\n  constructor(props, TaskManagerFactory, EventArgs) {\n    super(props);\n\n    this.TaskManagerFactory = TaskManagerFactory;\n    this.EventArgs = EventArgs;\n\n    const { config, centerOnCursor } = props;\n    const { highlightItem, cursorItem, selectedItems } = config;\n\n    this.state = {\n      config,\n      viewportSize: {\n        width: 0,\n        height: 0\n      },\n      contentPosition: {\n        x: 0,\n        y: 0\n      },\n      centerOnCursor,\n      highlightItem,\n      cursorItem,\n      selectedItems: (selectedItems || []).slice()\n    };\n\n    const { viewportSize } = this.state;\n\n    this.onRefreshViewport = this.onRefreshViewport.bind(this);\n    this.onSizeChanged = this.onSizeChanged.bind(this);\n    this.onScroll = this.onScroll.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onClick = this.onClick.bind(this);\n    this.onCheckboxChange = this.onCheckboxChange.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n\n    this.onFrameClick = this.onFrameClick.bind(this);\n    this.onFrameMouseMove = this.onFrameMouseMove.bind(this);\n\n    this.getOptions = this.getOptions.bind(this);\n    this.getGraphics = this.getGraphics.bind(this);\n    this.getLayout = this.getLayout.bind(this);\n    this.setLayout = this.setLayout.bind(this);\n    this.getEventArgs = this.getEventArgs.bind(this);\n    this.centerOnCursor = this.centerOnCursor.bind(this);\n\n    this.onItemRender = this.onItemRender.bind(this);\n    this.onHighlightRender = this.onHighlightRender.bind(this);\n    this.onCursorRender = this.onCursorRender.bind(this);\n\n\n    this.controlPanelRef = React.createRef();\n    this.frameMousePanelRef = React.createRef();\n    this.framePlaceholderRef = React.createRef();\n    this.titlesMousePanelRef = React.createRef();\n    this.titlesPlaceholderRef = React.createRef();\n    this.scrollPanelRef = React.createRef();\n    this.mousePanelRef = React.createRef();\n    this.placeholderRef = React.createRef();\n    this.calloutPlaceholderRef = React.createRef();\n\n    this.layoutOptions = {};\n    this.templatesHash = {};\n    this.graphics = new Graphics(viewportSize);\n    this.templates = {\n      AnnotationLabelTemplate,\n      ButtonsTemplate,\n      CheckBoxTemplate,\n      CursorTemplate,\n      DotHighlightTemplate,\n      GroupTitleTemplate,\n      HighlightTemplate,\n      ItemTemplate,\n      UserTemplate,\n      LabelAnnotationTemplate,\n      LevelTitleTemplate,\n      LevelBackgroundTemplate\n    }\n    this.tasks = TaskManagerFactory(this.getOptions, this.getGraphics, this.getLayout, this.setLayout, this.templates);\n  }\n\n  static getDerivedStateFromProps(nextProps, state) {\n    const { config: nextConfig, centerOnCursor } = nextProps;\n    const { config } = state;\n    if (config !== nextConfig) {\n      const { highlightItem, cursorItem, selectedItems } = nextConfig;\n      return {\n        config: nextConfig,\n        highlightItem,\n        cursorItem,\n        selectedItems: (selectedItems || []).slice(),\n        centerOnCursor\n      };\n    }\n    return null;\n  }\n\n  componentDidMount() {\n    // The following code is ResizeObserver Polyfill\n    // It is added to the rendered page to track size changes of control placeholder\n    // npm install resize-observer-polyfill --save-dev\n    require('resize-observer-polyfill/dist/ResizeObserver.global');\n    this.observer = new ResizeObserver(this.onSizeChanged);\n    this.observer.observe(this.controlPanelRef.current);\n\n    this.centerOnCursor();\n    this.fixPixelAlignment();\n  }\n\n  componentWillUnmount() {\n    // destroy timer\n    clearTimeout(this.timer);\n    this.timer = null;\n    // destroy observer\n    this.observer.disconnect();\n  }\n\n  componentDidUpdate() {\n    this.centerOnCursor();\n  }\n\n  centerOnCursor() {\n    const { centerOnCursor } = this.state;\n    if (centerOnCursor) {\n      /* scroll to offset */\n      const centerOnCursorTask = this.tasks.getTask(\"CenterOnCursorTask\");\n      const placeholderOffset = centerOnCursorTask.getPlaceholderOffset();\n      const { x: scrollLeft, y: scrollTop } = placeholderOffset;\n      this.scrollPanelRef.current.scrollLeft = scrollLeft;\n      this.scrollPanelRef.current.scrollTop = scrollTop;\n    }\n  }\n\n  fixPixelAlignment() {\n    const { current } = this.controlPanelRef;\n    var pixelAlignmentFix = getFixOfPixelAlignment(current);\n    current.style.marginLeft = pixelAlignmentFix.width + \"px\";\n    current.style.marginTop = pixelAlignmentFix.height + \"px\";\n  }\n\n  onSizeChanged() {\n    const { width, height } = getInnerSize(this.controlPanelRef.current)\n    this.setState({\n      viewportSize: {\n        width,\n        height\n      },\n      centerOnCursor: true\n    });\n  }\n\n  onScroll() {\n    if (this.timer == null) {\n      this.timer = setTimeout(this.onRefreshViewport, 200);\n    }\n  }\n\n  onRefreshViewport() {\n    clearTimeout(this.timer);\n    this.timer = null;\n\n    const { scrollTop, scrollLeft } = this.scrollPanelRef.current;\n    this.setState({\n      contentPosition: { x: Math.floor(scrollLeft), y: Math.floor(scrollTop) },\n      centerOnCursor: false\n    });\n  }\n\n  onFrameMouseMove(event) {const placeholderOffset = getElementOffset(this.frameMousePanelRef.current),\n      x = event.pageX - placeholderOffset.left,\n      y = event.pageY - placeholderOffset.top,\n      projectItemsToFrameTask = this.tasks.getTask(\"ProjectItemsToFrameTask\"),\n      highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\");\n\n    if (highlightItemOptionTask.hasHighlightEnabled()) {\n      const itemId = projectItemsToFrameTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius());\n      this.setHighlightItem(event, itemId);\n    }\n  }\n\n  onFrameClick(event) {\n    const placeholderOffset = getElementOffset(this.frameMousePanelRef.current),\n      x = event.pageX - placeholderOffset.left,\n      y = event.pageY - placeholderOffset.top,\n      projectItemsToFrameTask = this.tasks.getTask(\"ProjectItemsToFrameTask\"),\n      cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n      highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n      newCursorItemId = projectItemsToFrameTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius());\n    if (newCursorItemId !== null) {\n      if (cursorItemOptionTask.hasCursorEnabled()) {\n        this.setCursorItem(event, newCursorItemId);\n        this.controlPanelRef.current.focus();\n      }\n    }\n  }\n\n  onMouseMove(event) {\n    const placeholderOffset = getElementOffset(this.mousePanelRef.current),\n      x = event.pageX - placeholderOffset.left,\n      y = event.pageY - placeholderOffset.top,\n      createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n      highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\");\n\n    if (highlightItemOptionTask.hasHighlightEnabled()) {\n      const itemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius());\n      this.setHighlightItem(event, itemId);\n    }\n  }\n\n  getEventArgs(oldTreeItemId, newTreeItemId, name) {\n    var result = new this.EventArgs(),\n      combinedContextsTask = this.tasks.getTask(\"CombinedContextsTask\"),\n      alignDiagramTask = this.tasks.getTask(\"AlignDiagramTask\"),\n      oldItemConfig = combinedContextsTask.getConfig(oldTreeItemId),\n      newItemConfig = combinedContextsTask.getConfig(newTreeItemId),\n      itemPosition,\n      offset,\n      panelOffset;\n\n    if (oldItemConfig && oldItemConfig.id != null) {\n      result.oldContext = oldItemConfig;\n    }\n\n    if (newItemConfig && newItemConfig.id != null) {\n      result.context = newItemConfig;\n\n      if (newItemConfig.parent !== null) {\n        result.parentItem = combinedContextsTask.getConfig(newItemConfig.parent);\n      }\n\n      panelOffset = getElementOffset(this.mousePanelRef.current);\n      offset = getElementOffset(this.scrollPanelRef.current);\n      itemPosition = alignDiagramTask.getItemPosition(newTreeItemId);\n      result.position = new Rect(itemPosition.actualPosition)\n        .translate(panelOffset.left, panelOffset.top)\n        .translate(-offset.left, -offset.top);\n    }\n\n    if (name != null) {\n      result.name = name;\n    }\n\n    return result;\n  }\n\n  setHighlightItem(event, newHighlightItemId) {\n    let eventArgs, cancel = false;\n    const { onHighlightChanging, onHighlightChanged } = this.props;\n    const { highlightItem } = this.state;\n    if (newHighlightItemId !== highlightItem) {\n      eventArgs = this.getEventArgs(highlightItem, newHighlightItemId);\n\n      if (onHighlightChanging != null) {\n        if (!onHighlightChanging(event, eventArgs)) {\n          cancel = true;\n          this.setState({\n            highlightItem: newHighlightItemId\n          });\n        }\n      } else {\n        this.setState({\n          highlightItem: newHighlightItemId\n        });\n      };\n      if (!cancel) {\n        if (onHighlightChanged != null) {\n          onHighlightChanged(event, eventArgs);\n        }\n      }\n    }\n  }\n\n  setCursorItem(event, newCursorItemId) {\n    let eventArgs, cancel = false;\n    const { onCursorChanging, onCursorChanged } = this.props;\n    const { cursorItem } = this.state;\n    if (newCursorItemId !== cursorItem) {\n      eventArgs = this.getEventArgs(cursorItem, newCursorItemId);\n\n      if (onCursorChanging != null) {\n        if (!onCursorChanging(event, eventArgs)) {\n          cancel = true;\n          this.setState({\n            cursorItem: newCursorItemId,\n            centerOnCursor: true\n          });\n        }\n      } else {\n        this.setState({\n          cursorItem: newCursorItemId,\n          centerOnCursor: true\n        });\n      }\n\n\n      if (!cancel) {\n        if (onCursorChanged != null) {\n          onCursorChanged(event, eventArgs);\n        }\n      }\n    }\n  }\n\n  onClick(event) {\n    var placeholderOffset = getElementOffset(this.mousePanelRef.current),\n      x = event.pageX - placeholderOffset.left,\n      y = event.pageY - placeholderOffset.top,\n      createTransformTask = this.tasks.getTask(\"CreateTransformTask\"),\n      cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n      highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n      newCursorItemId = createTransformTask.getTreeItemForMousePosition(x, y, highlightItemOptionTask.getGravityRadius()),\n      target;\n    target = event.target;\n    if (newCursorItemId !== null) {\n      if (target.getAttribute(\"name\") === \"checkbox\" || target.getAttribute(\"name\") === \"selectiontext\") { //ignore jslint\n\n      }\n      else {\n        if (cursorItemOptionTask.hasCursorEnabled()) {\n          this.setCursorItem(event, newCursorItemId);\n          this.controlPanelRef.current.focus();\n        }\n      }\n    }\n  }\n\n  onCheckboxChange(event) {\n    const { onSelectionChanging, onSelectionChanged } = this.props;\n    let { selectedItems } = this.state;\n    let newSelectedItems = [];\n    const { target } = event;\n    var itemid = target.getAttribute(\"data-id\");\n    const checked = event.target.checked\n    let cancel = false;\n    if (itemid != null) {\n      if (checked) {\n        newSelectedItems = [...selectedItems, itemid];\n      }\n      else {\n        // eslint-disable-next-line\n        newSelectedItems = selectedItems.filter(id => id != itemid); // User type may not mach string value in data attribute\n      }\n      if (onSelectionChanging != null) {\n        cancel = onSelectionChanging(event, selectedItems, newSelectedItems)\n      }\n      if (!cancel) {\n        this.setState({\n          selectedItems: newSelectedItems\n        })\n\n        if (onSelectionChanged != null) {\n          onSelectionChanged(event, selectedItems, newSelectedItems);\n        }\n      }\n    }\n  }\n\n  onKeyDown(event) {\n    var highlightItemTask = this.tasks.getTask(\"HighlightItemTask\"),\n      highlightItemOptionTask = this.tasks.getTask(\"HighlightItemOptionTask\"),\n      cursorItemTask = this.tasks.getTask(\"CursorItemTask\"),\n      cursorItemOptionTask = this.tasks.getTask(\"CursorItemOptionTask\"),\n      alignDiagramTask = this.tasks.getTask('AlignDiagramTask'),\n      createTransformTask = this.tasks.getTask('CreateTransformTask'),\n      transform = createTransformTask.getTransform(),\n      navigationItem = null,\n      newNavigationItem,\n      direction = null,\n      accepted;\n\n    if (highlightItemOptionTask.hasHighlightEnabled() && cursorItemOptionTask.hasCursorEnabled()) {\n      navigationItem = highlightItemTask.getHighlightTreeItem();\n      if (navigationItem === null) {\n        navigationItem = cursorItemTask.getCursorTreeItem();\n      }\n    } else if (highlightItemOptionTask.hasHighlightEnabled()) {\n      navigationItem = highlightItemTask.getHighlightTreeItem();\n    } else if (cursorItemOptionTask.hasCursorEnabled()) {\n      navigationItem = cursorItemTask.getCursorTreeItem();\n    }\n\n\n    if (navigationItem != null) {\n      switch (event.which) {\n        case 13: /*Enter*/\n          if (cursorItemOptionTask.hasCursorEnabled()) {\n            this.setCursorItem(event, navigationItem);\n            event.preventDefault();\n            this.controlPanelRef.current.focus();\n          }\n          break;\n        case 40: /*Down*/\n          direction = OrientationType.Bottom;\n          break;\n        case 38: /*Up*/\n          direction = OrientationType.Top;\n          break;\n        case 37: /*Left*/\n          direction = OrientationType.Left;\n          break;\n        case 39: /*Right*/\n          direction = OrientationType.Right;\n          break;\n        default:\n          break;\n      }\n\n      if (direction != null) {\n\n        accepted = false;\n\n        while (!accepted) {\n          accepted = true;\n\n          direction = transform.getOrientation(direction);\n          newNavigationItem = alignDiagramTask.getNextItem(navigationItem, direction);\n\n          if (newNavigationItem != null) {\n            event.preventDefault();\n            if (highlightItemOptionTask.hasHighlightEnabled()) {\n              this.setHighlightItem(event, newNavigationItem);\n            } else if (cursorItemOptionTask.hasCursorEnabled()) {\n              this.setCursorItem(event, newNavigationItem);\n            }\n\n          }\n        }\n        this.controlPanelRef.current.focus();\n      }\n    }\n  }\n\n  onItemRender(data) {\n    const { templateName } = data;\n    const template = this.templatesHash[templateName];\n    return template.onItemRender(data);\n  }\n\n  onHighlightRender(data) {\n    const { templateName } = data;\n    const template = this.templatesHash[templateName];\n    return template.onHighlightRender(data);\n  }\n\n  onCursorRender(data) {\n    const { templateName } = data;\n    const template = this.templatesHash[templateName];\n    return template.onCursorRender(data);\n  }\n\n  getOptions() {\n    const { config } = this.props;\n    const templates = config.templates || [];\n\n    const effectiveTemplates = templates.map(template => {\n      const { onItemRender, onHighlightRender, onCursorRender } = template;\n      return {\n        ...template,\n        itemTemplate: (!onItemRender ? null : \"<p>This template is not being used in React</p>\"),\n        highlightTemplate: (!onHighlightRender ? null : \"<p>This template is not being used in React</p>\"),\n        cursorTemplate: (!onCursorRender ? null : \"<p>This template is not being used in React</p>\")\n      };\n    });\n\n    this.templatesHash = templates.reduce((agg, template) => {\n      const { name } = template;\n      agg[name] = template;\n      return agg;\n    }, {});\n\n    const { highlightItem, cursorItem, selectedItems } = this.state;\n    return {\n      ...config,\n      templates: effectiveTemplates,\n      highlightItem,\n      cursorItem,\n      selectedItems,\n      onItemRender: this.onItemRender,\n      onCursorRender: this.onCursorRender,\n      onHighlightRender: this.onHighlightRender\n    };\n  }\n\n  getGraphics() {\n    return this.graphics;\n  }\n\n  getLayout() {\n    const { centerOnCursor, viewportSize, contentPosition } = this.state;\n    return {\n      forceCenterOnCursor: centerOnCursor,\n      scrollPanelSize: new Size(viewportSize),\n      placeholderOffset: new Point(contentPosition)\n    }\n  }\n\n  setLayout(layoutOptions) {\n    const { \n        autoSize, // resize control if true\n        controlSize, // Sets control Size in auto scale mode\n        scale, // scale is needed for scale transform CSS creation\n        frameMousePanelRect,\n        framePlaceholderSize, // the frame content size before CSS Scale Transform applied\n        titlesMousePanelRect,\n        titlesPlaceholderSize, // Titles size before CSS Scale Transform applied\n        scrollPanelRect,\n        mousePanelSize, // Content mouse panel size\n        placeholderSize // Content size before CSS Scale Transform applied\n    } = layoutOptions;\n\n    this.layoutOptions = {\n      autoSize,\n      controlSize: new Size(controlSize),\n      scale,\n      frameMousePanelRect: new Rect(frameMousePanelRect),\n      framePlaceholderSize: new Size(framePlaceholderSize),\n\n      titlesMousePanelRect: new Rect(titlesMousePanelRect),\n      titlesPlaceholderSize: new Size(titlesPlaceholderSize),\n\n      scrollPanelRect: new Rect(scrollPanelRect),\n      mousePanelSize: new Size(mousePanelSize),\n      placeholderSize: new Size(placeholderSize)\n    }\n  }\n\n  render() {\n    const graphics = this.graphics;\n    this.tasks.process('OptionsTask', null, false);\n\n    const { placeholder, calloutplaceholder, frameplaceholder, titlesplaceholder } = this.graphics.placeholders;\n    const placeholderRectCSS = placeholder.rect.getCSS();\n\n    const { \n      autoSize, // resize control if true\n      controlSize, // Sets control Size in auto scale mode\n      scale, // scale is needed for scale transform CSS creation\n      frameMousePanelRect,\n      titlesMousePanelRect,\n      scrollPanelRect,\n      mousePanelSize // Content mouse panel size\n    } = this.layoutOptions;\n\n    /* set CSS scale of content */\n    var scaletext = \"scale(\" + scale + \",\" + scale + \")\";\n\n    return <>\n      <div /* root control panel */\n        ref={this.controlPanelRef}\n        onKeyDown={this.onKeyDown}\n        style={{\n          position: \"relative\",\n          overflow: \"hidden\",\n          top: \"0px\",\n          left: \"0px\",\n          width: \"100%\",\n          height: \"100%\",\n          padding: \"0px\",\n          marginBottom: \"0px\",\n          marginRight: \"0px\",\n          ...(autoSize ? controlSize.getCSS() : {})\n        }}\n        tabIndex=\"0\"\n      >\n        {frameplaceholder &&\n          <div\n            ref={this.frameMousePanelRef}\n            onMouseMove={this.onFrameMouseMove}\n            onClick={this.onFrameClick}\n            style={{\n              position: \"absolute\",\n              overflow: \"hidden\",\n              ...(frameMousePanelRect.getCSS())\n            }}>\n            <div\n              ref={this.framePlaceholderRef}\n              style={{\n                ...(frameplaceholder.rect.getCSS()),\n                position: \"absolute\",\n                overflow: \"hidden\",\n                \"transformOrigin\": \"0 0\",\n                \"transform\": scaletext,\n                \"msTransform\": scaletext, /* IE 9 */\n                \"WebkitTransform\": scaletext, /* Safari and Chrome */\n                \"OTransform\": scaletext, /* Opera */\n                \"MozTransform\": scaletext /* Firefox */\n              }}>\n              {graphics.map(this, \"frameplaceholder\", (layerKey, elements) =>\n                <div key={layerKey} style={{\n                  position: \"absolute\",\n                  overflow: \"visible\",\n                  left: \"0px\",\n                  top: \"0px\"\n                }}>\n                  {elements}\n                </div>\n              )}\n            </div>\n          </div>\n        }\n        {titlesplaceholder &&\n          <div\n            ref={this.titlesMousePanelRef}\n            onMouseMove={this.onFrameMouseMove}\n            onClick={this.onFrameClick}\n            style={{\n              position: \"absolute\",\n              overflow: \"hidden\",\n              ...(titlesMousePanelRect.getCSS())\n            }}>\n            <div\n              ref={this.titlesMousePanelRef}\n              style={{\n                ...(titlesplaceholder.rect.getCSS()),\n                position: \"absolute\",\n                overflow: \"hidden\",\n                \"transformOrigin\": \"0 0\",\n                \"transform\": scaletext,\n                \"msTransform\": scaletext, /* IE 9 */\n                \"WebkitTransform\": scaletext, /* Safari and Chrome */\n                \"OTransform\": scaletext, /* Opera */\n                \"MozTransform\": scaletext /* Firefox */\n              }}>\n              {graphics.map(this, \"titlesplaceholder\", (layerKey, elements) =>\n                <div key={layerKey} style={{\n                  position: \"absolute\",\n                  overflow: \"visible\",\n                  left: \"0px\",\n                  top: \"0px\"\n                }}>\n                  {elements}\n                </div>\n              )}\n            </div>\n          </div>\n        }\n        <div\n          ref={this.scrollPanelRef}\n          onScroll={this.onScroll}\n          style={{\n            position: \"absolute\",\n            overflow: \"auto\",\n            WebkitOverflowScrolling: \"touch\",\n            ...(scrollPanelRect.getCSS()),\n            border: (scrollPanelRect.x > 0 ? \"1px dotted #dddddd\" : \"\")\n          }}\n        >\n          <div\n            ref={this.mousePanelRef}\n            onMouseMove={this.onMouseMove}\n            onClick={this.onClick}\n            onChange={this.onCheckboxChange}\n            style={{\n              position: \"absolute\",\n              overflow: \"hidden\",\n              ...(mousePanelSize.getCSS())\n            }}>\n            <div\n              ref={this.placeholderRef}\n              style={{\n                ...placeholderRectCSS,\n                position: \"absolute\",\n                overflow: \"hidden\",\n                \"transformOrigin\": \"0 0\",\n                \"transform\": scaletext,\n                \"msTransform\": scaletext, /* IE 9 */\n                \"WebkitTransform\": scaletext, /* Safari and Chrome */\n                \"OTransform\": scaletext, /* Opera */\n                \"MozTransform\": scaletext /* Firefox */\n              }}>\n              {graphics.map(this, \"placeholder\", (layerKey, elements) =>\n                <div key={layerKey} style={{\n                  position: \"absolute\",\n                  overflow: \"visible\",\n                  left: \"0px\",\n                  top: \"0px\"\n                }}>\n                  {elements}\n                </div>\n              )}\n              {calloutplaceholder &&\n                <div key=\"Callout\"\n                  style={{\n                    position: \"absolute\",\n                    overflow: \"visible\",\n                    left: calloutplaceholder.rect.x + \"px\",\n                    top: calloutplaceholder.rect.y + \"px\"\n                  }}>\n                  {graphics.map(this, \"calloutplaceholder\", (layerKey, elements) =>\n                    <div key={layerKey} style={{\n                      position: \"absolute\",\n                      overflow: \"visible\"\n                    }}>\n                      {elements}\n                    </div>\n                  )}\n                </div>\n              }\n            </div>\n          </div>\n        </div>\n      </div>\n    </>;\n  }\n}\n\nexport default BaseDiagram;\n"]},"metadata":{},"sourceType":"module"}