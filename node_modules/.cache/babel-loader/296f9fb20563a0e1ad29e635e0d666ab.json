{"ast":null,"code":"import _objectSpread from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faUserPlus,faUserSlash}from'@fortawesome/free-solid-svg-icons';import{OrgDiagram}from'../Diagrams';import{LCA,Tree,PageFitMode,Enabled}from'basicprimitives';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Sample=/*#__PURE__*/function(_Component){_inherits(Sample,_Component);var _super=_createSuper(Sample);function Sample(props){var _this;_classCallCheck(this,Sample);_this=_super.call(this,props);_this.onAddButtonClick=_this.onAddButtonClick.bind(_assertThisInitialized(_this));_this.onRemoveButtonClick=_this.onRemoveButtonClick.bind(_assertThisInitialized(_this));_this.state={cursorItem:0,highlightItem:0,items:[{id:0,parent:null,title:\"James Smith\",description:\"VP, Public Sector\",image:\"/react/photos/a.png\"},{id:1,parent:0,title:\"Ted Lucas\",description:\"VP, Human Resources\",image:\"/react/photos/b.png\"},{id:2,parent:0,title:\"Fritz Stuger\",description:\"Business Solutions, US\",image:\"/react/photos/c.png\"},{id:3,parent:0,title:\"Lynne Rathinam\",description:\"GM, Enterprise Services\",image:\"/react/photos/c.png\"}]};_this.index=_this.state.items.length;return _this;}_createClass(Sample,[{key:\"onAddButtonClick\",value:function onAddButtonClick(itemConfig){var items=this.state.items;var newItem={id:this.index++,parent:itemConfig.id,title:\"New Title\",description:\"New Description\",image:\"/react/photos/z.png\"};this.setState({items:[].concat(_toConsumableArray(items),[newItem]),cursorItem:newItem.id});}},{key:\"onRemoveButtonClick\",value:function onRemoveButtonClick(itemConfig){var items=this.state.items;this.setState(this.getDeletedItems(items,[itemConfig.id]));}},{key:\"getDeletedItems\",value:function getDeletedItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var deletedItems=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var tree=this.getTree(items);var hash=deletedItems.reduce(function(agg,itemid){agg.add(itemid.toString());return agg;},new Set());var cursorParent=this.getDeletedItemsParent(tree,deletedItems,hash);var result=[];tree.loopLevels(this,function(nodeid,node){if(hash.has(nodeid.toString())){return tree.SKIP;}result.push(node);});return{items:result,cursorItem:cursorParent};}},{key:\"getDeletedItemsParent\",value:function getDeletedItemsParent(tree,deletedItems,deletedHash){var result=null;var lca=LCA(tree);result=deletedItems.reduce(function(agg,itemid){if(agg==null){agg=itemid;}else{agg=lca.getLowestCommonAncestor(agg,itemid);}return agg;},null);if(deletedHash.has(result.toString())){result=tree.parentid(result);}return result;}},{key:\"getTree\",value:function getTree(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var tree=Tree();// rebuild tree\nfor(var index=0;index<items.length;index+=1){var item=items[index];tree.add(item.parent,item.id,item);}return tree;}},{key:\"render\",value:function render(){var _this2=this;var config=_objectSpread(_objectSpread({},this.state),{},{pageFitMode:PageFitMode.None,hasSelectorCheckbox:Enabled.True,hasButtons:Enabled.True,buttonsPanelSize:40,onButtonsRender:function onButtonsRender(_ref){var itemConfig=_ref.context;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"StyledButton\",onClick:function onClick(event){event.stopPropagation();_this2.onAddButtonClick(itemConfig);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserPlus})},\"1\"),/*#__PURE__*/_jsx(\"button\",{className:\"StyledButton\",onClick:function onClick(event){event.stopPropagation();_this2.onRemoveButtonClick(itemConfig);},children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faUserSlash})},\"2\")]});}});return/*#__PURE__*/_jsx(\"div\",{className:\"placeholder\",children:/*#__PURE__*/_jsx(OrgDiagram,{centerOnCursor:true,config:config})});}}]);return Sample;}(Component);export default Sample;","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/src/Samples/AddingNewItemsToChartAtRuntime.js"],"names":["React","Component","FontAwesomeIcon","faUserPlus","faUserSlash","OrgDiagram","LCA","Tree","PageFitMode","Enabled","Sample","props","onAddButtonClick","bind","onRemoveButtonClick","state","cursorItem","highlightItem","items","id","parent","title","description","image","index","length","itemConfig","newItem","setState","getDeletedItems","deletedItems","tree","getTree","hash","reduce","agg","itemid","add","toString","Set","cursorParent","getDeletedItemsParent","result","loopLevels","nodeid","node","has","SKIP","push","deletedHash","lca","getLowestCommonAncestor","parentid","item","config","pageFitMode","None","hasSelectorCheckbox","True","hasButtons","buttonsPanelSize","onButtonsRender","context","event","stopPropagation"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUserPlus, faUserSlash } from '@fortawesome/free-solid-svg-icons'\nimport { OrgDiagram } from '../Diagrams';\nimport { LCA, Tree, PageFitMode, Enabled } from 'basicprimitives';\n\nclass Sample extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onAddButtonClick = this.onAddButtonClick.bind(this);\n    this.onRemoveButtonClick = this.onRemoveButtonClick.bind(this);\n\n    this.state = {\n      cursorItem: 0,\n      highlightItem: 0,\n      items: [\n        {\n          id: 0,\n          parent: null,\n          title: \"James Smith\",\n          description: \"VP, Public Sector\",\n          image: \"/react/photos/a.png\"\n        },\n        {\n          id: 1,\n          parent: 0,\n          title: \"Ted Lucas\",\n          description: \"VP, Human Resources\",\n          image: \"/react/photos/b.png\"\n        },\n        {\n          id: 2,\n          parent: 0,\n          title: \"Fritz Stuger\",\n          description: \"Business Solutions, US\",\n          image: \"/react/photos/c.png\"\n        },\n        {\n          id: 3,\n          parent: 0,\n          title: \"Lynne Rathinam\",\n          description: \"GM, Enterprise Services\",\n          image: \"/react/photos/c.png\"\n        }\n      ]\n    }\n\n    this.index = this.state.items.length;\n  }\n\n  onAddButtonClick(itemConfig) {\n    const { items } = this.state;\n\n    var newItem = {\n      id: this.index++,\n      parent: itemConfig.id,\n      title: \"New Title\",\n      description: \"New Description\",\n      image: \"/react/photos/z.png\"\n    };\n\n    this.setState({\n      items: [...items, newItem],\n      cursorItem: newItem.id\n    });\n  }\n\n  onRemoveButtonClick(itemConfig) {\n    const { items } = this.state;\n\n    this.setState(this.getDeletedItems(items, [itemConfig.id]));\n  }\n\n  getDeletedItems(items = [], deletedItems = []) {\n    const tree = this.getTree(items);\n    const hash = deletedItems.reduce((agg, itemid) => {\n      agg.add(itemid.toString());\n      return agg;\n    }, new Set());\n    const cursorParent = this.getDeletedItemsParent(tree, deletedItems, hash);\n    const result = [];\n    tree.loopLevels(this, (nodeid, node) => {\n      if (hash.has(nodeid.toString())) {\n        return tree.SKIP;\n      }\n      result.push(node);\n    });\n\n    return {\n      items: result,\n      cursorItem: cursorParent\n    };\n  }\n\n  getDeletedItemsParent(tree, deletedItems, deletedHash) {\n    let result = null;\n    const lca = LCA(tree);\n    result = deletedItems.reduce((agg, itemid) => {\n      if (agg == null) {\n        agg = itemid;\n      } else {\n        agg = lca.getLowestCommonAncestor(agg, itemid);\n      }\n      return agg;\n    }, null);\n\n    if (deletedHash.has(result.toString())) {\n      result = tree.parentid(result);\n    }\n    return result;\n  }\n\n  getTree(items = []) {\n    const tree = Tree();\n\n    // rebuild tree\n    for (let index = 0; index < items.length; index += 1) {\n      const item = items[index];\n      tree.add(item.parent, item.id, item);\n    }\n\n    return tree;\n  }\n\n  render() {\n    const config = {\n      ...this.state,\n      pageFitMode: PageFitMode.None,\n      hasSelectorCheckbox: Enabled.True,\n      hasButtons: Enabled.True,\n      buttonsPanelSize: 40,\n      onButtonsRender: (({ context: itemConfig }) => {\n        return <>\n          <button key=\"1\" className=\"StyledButton\"\n            onClick={(event) => {\n              event.stopPropagation();\n              this.onAddButtonClick(itemConfig);\n            }}>\n            <FontAwesomeIcon icon={faUserPlus} />\n          </button>\n          <button key=\"2\" className=\"StyledButton\"\n            onClick={(event) => {\n              event.stopPropagation();\n              this.onRemoveButtonClick(itemConfig);\n            }}>\n            <FontAwesomeIcon icon={faUserSlash} />\n          </button>\n        </>\n      })\n    };\n\n    return <div className=\"placeholder\">\n      <OrgDiagram centerOnCursor={true} config={config} />\n    </div >\n  }\n}\n\nexport default Sample;\n"]},"metadata":{},"sourceType":"module"}