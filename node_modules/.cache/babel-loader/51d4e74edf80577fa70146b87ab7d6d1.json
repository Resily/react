{"ast":null,"code":"import _objectSpread from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/01005901/go/src/github.com/Resily/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{OrgDiagram}from'../Diagrams';import{LCA,Tree,Colors,PageFitMode,Enabled,OrientationType}from'basicprimitives';import{DndProvider,DropTarget,DragSource}from'react-dnd';import{HTML5Backend}from'react-dnd-html5-backend';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Sample=/*#__PURE__*/function(_Component){_inherits(Sample,_Component);var _super=_createSuper(Sample);function Sample(){var _this;_classCallCheck(this,Sample);_this=_super.call(this);_this.onRemoveItem=_this.onRemoveItem.bind(_assertThisInitialized(_this));_this.state={cursorItem:0,highlightItem:0,items:[{id:0,parent:null,description:\"Chief Executive Officer (CEO)\",email:\"davidalt@name.com\",image:\"/react/photos/q.png\",itemTitleColor:\"#4169e1\",phone:\"352-206-7599\",title:\"David Dalton\",label:\"David Dalton\"},{id:1,parent:0,description:\"Co-Presidents, Platform Products & Services Division\",email:\"jeanwhit@name.com\",image:\"/react/photos/w.png\",phone:\"505-791-1689\",title:\"Jeanna White\",label:\"Jeanna White\"},{id:2,parent:0,description:\"Sr. VP, Server & Tools Division\",email:\"jameholt@name.com\",image:\"/react/photos/e.png\",phone:\"262-215-7998\",title:\"James Holt\",label:\"James Holt\"},{id:3,parent:null,description:\"VP, Server & Tools Marketing and Solutions\",email:\"thomwill@name.com\",image:\"/react/photos/r.png\",phone:\"904-547-5342\",title:\"Thomas Williams\",label:\"Thomas Williams\"},{id:4,parent:3,description:\"VP, Software & Enterprise Management Division\",email:\"sarakemp@name.com\",image:\"/react/photos/g.png\",phone:\"918-257-4218\",title:\"Sara Kemp\",label:\"Sara Kemp\"},{id:5,parent:3,description:\"Sr. VP, Software Server System\",email:\"georduon@name.com\",image:\"/react/photos/x.png\",phone:\"434-406-2189\",title:\"George Duong\",label:\"George Duong\"}]};return _this;}_createClass(Sample,[{key:\"onRemoveItem\",value:function onRemoveItem(id){var items=this.state.items;this.setState(this.getDeletedItems(items,[id]));}},{key:\"getDeletedItems\",value:function getDeletedItems(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var deletedItems=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var tree=this.getTree(items);var hash=deletedItems.reduce(function(agg,itemid){agg.add(itemid.toString());return agg;},new Set());var cursorParent=this.getDeletedItemsParent(tree,deletedItems,hash);var result=[];tree.loopLevels(this,function(nodeid,node){if(hash.has(nodeid.toString())){return tree.SKIP;}result.push(node);});return{items:result,cursorItem:cursorParent};}},{key:\"getDeletedItemsParent\",value:function getDeletedItemsParent(tree,deletedItems,deletedHash){var result=null;var lca=LCA(tree);result=deletedItems.reduce(function(agg,itemid){if(agg==null){agg=itemid;}else{agg=lca.getLowestCommonAncestor(agg,itemid);}return agg;},null);if(deletedHash.has(result.toString())){result=tree.parentid(result);}return result;}},{key:\"getTree\",value:function getTree(){var items=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var tree=Tree();// rebuild tree\nfor(var index=0;index<items.length;index+=1){var item=items[index];tree.add(item.parent,item.id,item);}return tree;}},{key:\"render\",value:function render(){var _this2=this;var ItemTypes={NODE:'node'};var TrashBin=function TrashBin(_ref){var canDrop=_ref.canDrop,isOver=_ref.isOver,connectDropTarget=_ref.connectDropTarget;var isActive=canDrop&&isOver;var backgroundColor='#222';if(isActive){backgroundColor='red';}else if(canDrop){backgroundColor='darkgreen';}var style={height:\"50px\",width:\"100%\",color:'white',textAlign:'center',fontSize:\"14px\",lineHeight:'normal',float:'left',marginBottom:\"10px\"};return/*#__PURE__*/_jsx(\"div\",{ref:connectDropTarget,style:_objectSpread(_objectSpread({},style),{},{backgroundColor:backgroundColor}),children:isActive?'Release to delete':'Drag a node here to delete'});};var TrashBinDropTarget=DropTarget(ItemTypes.NODE,{drop:function drop(){return{id:-1};}},function(connect,monitor){return{connectDropTarget:connect.dropTarget(),isOver:monitor.isOver(),canDrop:monitor.canDrop()};})(TrashBin);var Node=function Node(_ref2){var itemConfig=_ref2.itemConfig,isDragging=_ref2.isDragging,connectDragSource=_ref2.connectDragSource;var opacity=isDragging?0.4:1;var itemTitleColor=itemConfig.itemTitleColor!=null?itemConfig.itemTitleColor:Colors.RoyalBlue;return/*#__PURE__*/_jsxs(\"div\",{className:\"ContactTemplate\",ref:connectDragSource,style:{opacity:opacity},children:[/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitleBackground\",style:{backgroundColor:itemTitleColor},children:/*#__PURE__*/_jsx(\"div\",{className:\"ContactTitle\",children:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhotoFrame\",children:/*#__PURE__*/_jsx(\"img\",{className:\"ContactPhoto\",src:itemConfig.image,alt:itemConfig.title})}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactPhone\",children:itemConfig.phone}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactEmail\",children:itemConfig.email}),/*#__PURE__*/_jsx(\"div\",{className:\"ContactDescription\",children:itemConfig.description})]});};var NodeDragSource=DragSource(ItemTypes.NODE,{beginDrag:function beginDrag(_ref3){var itemConfig=_ref3.itemConfig;return{id:itemConfig.id};},endDrag:function endDrag(props,monitor){var onRemoveItem=props.onRemoveItem;var item=monitor.getItem();var dropResult=monitor.getDropResult();if(dropResult){if(dropResult.id===-1){onRemoveItem(item.id);}}}},function(connect,monitor){return{connectDragSource:connect.dragSource(),isDragging:monitor.isDragging()};})(Node);var config=_objectSpread(_objectSpread({},this.state),{},{pageFitMode:PageFitMode.None,hasSelectorCheckbox:Enabled.True,orientationType:OrientationType.Top,defaultTemplateName:\"contactTemplate\",templates:[{name:\"contactTemplate\",itemSize:{width:220,height:120},minimizedItemSize:{width:3,height:3},highlightPadding:{left:2,top:2,right:2,bottom:2},onItemRender:function onItemRender(_ref4){var itemConfig=_ref4.context;return/*#__PURE__*/_jsx(NodeDragSource,{itemConfig:itemConfig,onRemoveItem:_this2.onRemoveItem});}}]});return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(DndProvider,{backend:HTML5Backend,children:[/*#__PURE__*/_jsx(TrashBinDropTarget,{}),/*#__PURE__*/_jsx(\"div\",{className:\"placeholder\",style:{clear:'both'},children:/*#__PURE__*/_jsx(OrgDiagram,{centerOnCursor:true,config:config})})]})});}}]);return Sample;}(Component);export default Sample;","map":{"version":3,"sources":["/Users/01005901/go/src/github.com/Resily/react/src/Samples/DragToTrashBin.js"],"names":["React","Component","OrgDiagram","LCA","Tree","Colors","PageFitMode","Enabled","OrientationType","DndProvider","DropTarget","DragSource","HTML5Backend","Sample","onRemoveItem","bind","state","cursorItem","highlightItem","items","id","parent","description","email","image","itemTitleColor","phone","title","label","setState","getDeletedItems","deletedItems","tree","getTree","hash","reduce","agg","itemid","add","toString","Set","cursorParent","getDeletedItemsParent","result","loopLevels","nodeid","node","has","SKIP","push","deletedHash","lca","getLowestCommonAncestor","parentid","index","length","item","ItemTypes","NODE","TrashBin","canDrop","isOver","connectDropTarget","isActive","backgroundColor","style","height","width","color","textAlign","fontSize","lineHeight","float","marginBottom","TrashBinDropTarget","drop","connect","monitor","dropTarget","Node","itemConfig","isDragging","connectDragSource","opacity","RoyalBlue","NodeDragSource","beginDrag","endDrag","props","getItem","dropResult","getDropResult","dragSource","config","pageFitMode","None","hasSelectorCheckbox","True","orientationType","Top","defaultTemplateName","templates","name","itemSize","minimizedItemSize","highlightPadding","left","top","right","bottom","onItemRender","context","clear"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { OrgDiagram } from '../Diagrams';\nimport { LCA, Tree, Colors, PageFitMode, Enabled, OrientationType } from 'basicprimitives';\nimport { DndProvider, DropTarget, DragSource } from 'react-dnd';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\n\nclass Sample extends Component {\n  constructor() {\n    super();\n\n    this.onRemoveItem = this.onRemoveItem.bind(this);\n\n    this.state = {\n      cursorItem: 0,\n      highlightItem: 0,\n      items: [\n        { id: 0, parent: null, description: \"Chief Executive Officer (CEO)\", email: \"davidalt@name.com\", image: \"/react/photos/q.png\", itemTitleColor: \"#4169e1\", phone: \"352-206-7599\", title: \"David Dalton\", label: \"David Dalton\" },\n        { id: 1, parent: 0, description: \"Co-Presidents, Platform Products & Services Division\", email: \"jeanwhit@name.com\", image: \"/react/photos/w.png\", phone: \"505-791-1689\", title: \"Jeanna White\", label: \"Jeanna White\" },\n        { id: 2, parent: 0, description: \"Sr. VP, Server & Tools Division\", email: \"jameholt@name.com\", image: \"/react/photos/e.png\", phone: \"262-215-7998\", title: \"James Holt\", label: \"James Holt\" },\n        { id: 3, parent: null, description: \"VP, Server & Tools Marketing and Solutions\", email: \"thomwill@name.com\", image: \"/react/photos/r.png\", phone: \"904-547-5342\", title: \"Thomas Williams\", label: \"Thomas Williams\" },\n        { id: 4, parent: 3, description: \"VP, Software & Enterprise Management Division\", email: \"sarakemp@name.com\", image: \"/react/photos/g.png\", phone: \"918-257-4218\", title: \"Sara Kemp\", label: \"Sara Kemp\" },\n        { id: 5, parent: 3, description: \"Sr. VP, Software Server System\", email: \"georduon@name.com\", image: \"/react/photos/x.png\", phone: \"434-406-2189\", title: \"George Duong\", label: \"George Duong\" }\n      ]\n    }\n  }\n\n  onRemoveItem(id) {\n    const { items } = this.state;\n\n    this.setState(this.getDeletedItems(items, [id]));\n  }\n\n  getDeletedItems(items = [], deletedItems = []) {\n    const tree = this.getTree(items);\n    const hash = deletedItems.reduce((agg, itemid) => {\n      agg.add(itemid.toString());\n      return agg;\n    }, new Set());\n    const cursorParent = this.getDeletedItemsParent(tree, deletedItems, hash);\n    const result = [];\n    tree.loopLevels(this, (nodeid, node) => {\n      if (hash.has(nodeid.toString())) {\n        return tree.SKIP;\n      }\n      result.push(node);\n    });\n\n    return {\n      items: result,\n      cursorItem: cursorParent\n    };\n  }\n\n  getDeletedItemsParent(tree, deletedItems, deletedHash) {\n    let result = null;\n    const lca = LCA(tree);\n    result = deletedItems.reduce((agg, itemid) => {\n      if (agg == null) {\n        agg = itemid;\n      } else {\n        agg = lca.getLowestCommonAncestor(agg, itemid);\n      }\n      return agg;\n    }, null);\n\n    if (deletedHash.has(result.toString())) {\n      result = tree.parentid(result);\n    }\n    return result;\n  }\n\n  getTree(items = []) {\n    const tree = Tree();\n\n    // rebuild tree\n    for (let index = 0; index < items.length; index += 1) {\n      const item = items[index];\n      tree.add(item.parent, item.id, item);\n    }\n\n    return tree;\n  }\n\n  render() {\n    const ItemTypes = {\n      NODE: 'node'\n    }\n\n    const TrashBin = ({ canDrop, isOver, connectDropTarget }) => {\n      const isActive = canDrop && isOver\n      let backgroundColor = '#222'\n      if (isActive) {\n        backgroundColor = 'red'\n      } else if (canDrop) {\n        backgroundColor = 'darkgreen'\n      }\n      const style = {\n        height: \"50px\",\n        width: \"100%\",\n        color: 'white',\n        textAlign: 'center',\n        fontSize: \"14px\",\n        lineHeight: 'normal',\n        float: 'left',\n        marginBottom: \"10px\"\n      }\n      return (\n        <div ref={connectDropTarget} style={{ ...style, backgroundColor }}>\n          {isActive ? 'Release to delete' : 'Drag a node here to delete'}\n        </div>\n      )\n    }\n    const TrashBinDropTarget = DropTarget(\n      ItemTypes.NODE,\n      {\n        drop: () => ({ id: -1 }),\n      },\n      (connect, monitor) => ({\n        connectDropTarget: connect.dropTarget(),\n        isOver: monitor.isOver(),\n        canDrop: monitor.canDrop(),\n      }),\n    )(TrashBin)\n\n    const Node = ({ itemConfig, isDragging, connectDragSource }) => {\n      const opacity = isDragging ? 0.4 : 1\n      const itemTitleColor = itemConfig.itemTitleColor != null ? itemConfig.itemTitleColor : Colors.RoyalBlue;\n      return (\n        <div className=\"ContactTemplate\" ref={connectDragSource} style={{ opacity }}>\n          <div className=\"ContactTitleBackground\" style={{ backgroundColor: itemTitleColor }}>\n            <div className=\"ContactTitle\">{itemConfig.title}</div>\n          </div>\n          <div className=\"ContactPhotoFrame\">\n            <img className=\"ContactPhoto\" src={itemConfig.image} alt={itemConfig.title} />\n          </div>\n          <div className=\"ContactPhone\">{itemConfig.phone}</div>\n          <div className=\"ContactEmail\">{itemConfig.email}</div>\n          <div className=\"ContactDescription\">{itemConfig.description}</div>\n        </div>\n      )\n    }\n    const NodeDragSource = DragSource(\n      ItemTypes.NODE,\n      {\n        beginDrag: ({ itemConfig }) => ({ id: itemConfig.id }),\n        endDrag(props, monitor) {\n          const { onRemoveItem } = props;\n          const item = monitor.getItem()\n          const dropResult = monitor.getDropResult()\n          if (dropResult) {\n            if (dropResult.id === -1) {\n              onRemoveItem(item.id);\n            }\n          }\n        },\n      },\n      (connect, monitor) => ({\n        connectDragSource: connect.dragSource(),\n        isDragging: monitor.isDragging(),\n      }),\n    )(Node);\n\n    const config = {\n      ...this.state,\n      pageFitMode: PageFitMode.None,\n\n      hasSelectorCheckbox: Enabled.True,\n      orientationType: OrientationType.Top,\n      defaultTemplateName: \"contactTemplate\",\n      templates: [{\n        name: \"contactTemplate\",\n        itemSize: { width: 220, height: 120 },\n        minimizedItemSize: { width: 3, height: 3 },\n        highlightPadding: { left: 2, top: 2, right: 2, bottom: 2 },\n        onItemRender: ({ context: itemConfig }) => {\n          return <NodeDragSource itemConfig={itemConfig} onRemoveItem={this.onRemoveItem} />;\n        }\n      }]\n    }\n    return <>\n      <DndProvider backend={HTML5Backend}>\n        <TrashBinDropTarget />\n        <div className=\"placeholder\" style={{ clear: 'both' }} >\n          <OrgDiagram centerOnCursor={true} config={config} />\n        </div>\n      </DndProvider>\n    </>;\n  }\n}\n\nexport default Sample;\n"]},"metadata":{},"sourceType":"module"}